<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Funis - GIGANTE</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            min-height: 100vh;
            color: white;
            padding: 30px;
            font-size: 18px; /* BASE MAIOR */
        }
        .container { max-width: 1800px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { font-size: 4rem; background: linear-gradient(45deg, #3b82f6, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .header p { font-size: 1.6rem; color: #94a3b8; }

        /* BOT√ïES MAIORES */
        .month-selector, .product-selector { gap: 15px; margin-bottom: 30px; }
        .month-btn, .product-btn { padding: 16px 32px; font-size: 1.3rem; border-radius: 12px; }
        .month-btn.active, .product-btn.active { font-weight: bold; }

        /* GRID MAIS ESPA√áADO */
        .dashboard-content { grid-template-columns: 280px 1fr 320px; gap: 30px; margin-bottom: 50px; }
        .sidebar { gap: 12px; }
        .metric-btn { padding: 18px 22px; font-size: 1.2rem; border-radius: 12px; }

        /* √ÅREA PRINCIPAL */
        .main-chart { padding: 35px; min-height: 600px; border-radius: 20px; }
        .chart-title { font-size: 2rem; margin-bottom: 30px; }

        /* === FUNIL GIGANTE === */
        .funnel-container { padding: 30px 50px; gap: 12px; }
        .funnel-stage {
            height: 80px; padding: 20px; border-radius: 20px; width: 95%; max-width: 900px;
            box-shadow: 0 12px 35px rgba(0,0,0,0.5);
        }
        .funnel-stage:hover { transform: scale(1.05); }
        .funnel-label { font-size: 1.4rem; font-weight: bold; margin-bottom: 6px; }
        .funnel-value { font-size: 3rem; font-weight: 900; }
        .funnel-percent { font-size: 1.2rem; font-weight: 600; }
        .funnel-arrow { font-size: 2.5rem; margin: 8px 0; }

        /* GR√ÅFICOS GIGANTES */
        .chart-container { height: 500px; }
        #mainChart { width: 100% !important; height: 100% !important; }

        /* STATS MAIORES */
        .stats-panel { gap: 20px; }
        .stat-card, .taxa-ascensao-card, .tendencias { padding: 25px; border-radius: 16px; }
        .stat-label { font-size: 1.1rem; }
        .stat-value { font-size: 2.5rem; }
        .taxa-ascensao-card .stat-value { font-size: 3.5rem; }

        /* BOTTOM & RANKING */
        .bottom-cards { gap: 30px; }
        .bottom-card { padding: 35px; }
        .bottom-card-icon { font-size: 3.5rem; }
        .bottom-card-label { font-size: 1.2rem; }
        .bottom-card-value { font-size: 2rem; }
        .ranking-section { padding: 40px; }
        .ranking-title { font-size: 2.2rem; }
        .ranking-card { padding: 30px; }
        .ranking-product { font-size: 1.6rem; }
        .ranking-value { font-size: 1.4rem; }

        /* RESPONSIVO */
        @media (max-width: 1200px) {
            body { font-size: 20px; padding: 20px; }
            .dashboard-content { grid-template-columns: 1fr; }
            .funnel-stage { height: 70px; }
            .funnel-value { font-size: 2.5rem; }
            .chart-container { height: 400px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä DASHBOARD FUNIS</h1>
            <p>An√°lise Completa de Performance por Produto</p>
        </div>
        <div class="month-selector" id="monthSelector"></div>
        <div class="product-selector" id="productSelector"></div>
        <div class="dashboard-content">
            <div class="sidebar" id="sidebar"></div>
            <div class="main-chart">
                <h2 class="chart-title" id="chartTitle">Carregando...</h2>
                <div id="chartArea" style="flex: 1; display: flex; align-items: center; justify-content: center;"></div>
            </div>
            <div class="stats-panel" id="statsPanel"></div>
        </div>
        <div class="bottom-cards" id="bottomCards"></div>
        <div class="ranking-section">
            <h2 class="ranking-title">üèÜ RANKING DE PRODUTOS</h2>
            <div class="ranking-grid" id="rankingGrid"></div>
        </div>
    </div>

    <script>
        // === JS COMPLETO (MESMO DO ANTERIOR, S√ì FUNIL E CHART AJUSTADOS ===

        const SHEET_ID = '1V0-yWzGbDWUEQ21CPtNcHrzPQfLTXKHNBYUlSfzO2Pc';
        const MONTHS = [ /* ... mesmo array ... */ ];
        const products = [ /* ... */ ];
        const metrics = [ /* ... */ ];
        let currentMonth = 'nov', currentProduct = 'Teste', currentMetric = 'geral';
        let chartInstance = null, allData = {};

        // ... (loadData, parseSheetData, renderUI, etc. ‚Äî 100% igual)

        function renderFunnel(semanas) {
            const totalAlunos = semanas.reduce((s, w) => s + w.alunos, 0);
            const totalQualificados = semanas.reduce((s, w) => s + w.qualificados, 0);
            const totalAgendados = semanas.reduce((s, w) => s + w.agendados, 0);
            const totalCallRealizada = semanas.reduce((s, w) => s + w.callRealizada, 0);
            const totalVendas = semanas.reduce((s, w) => s + w.numeroVenda, 0);

            document.getElementById('chartTitle').textContent = 'Funil de Convers√£o - ' + currentProduct;
            document.getElementById('chartArea').innerHTML = `
                <div class="funnel-container">
                    <div class="funnel-stage funnel-stage-1">
                        <div class="funnel-label">üë• Alunos</div>
                        <div class="funnel-value">${totalAlunos}</div>
                        <div class="funnel-percent">100%</div>
                    </div>
                    <div class="funnel-arrow">‚Üì</div>
                    <div class="funnel-stage funnel-stage-2">
                        <div class="funnel-label">‚úÖ Qualificados</div>
                        <div class="funnel-value">${totalQualificados}</div>
                        <div class="funnel-percent">${totalAlunos > 0 ? ((totalQualificados / totalAlunos) * 100).toFixed(1) : 0}%</div>
                    </div>
                    <div class="funnel-arrow">‚Üì</div>
                    <div class="funnel-stage funnel-stage-3">
                        <div class="funnel-label">üìÖ Call Agendadas</div>
                        <div class="funnel-value">${totalAgendados}</div>
                        <div class="funnel-percent">${totalQualificados > 0 ? ((totalAgendados / totalQualificados) * 100).toFixed(1) : 0}%</div>
                    </div>
                    <div class="funnel-arrow">‚Üì</div>
                    <div class="funnel-stage funnel-stage-4">
                        <div class="funnel-label">üìû Call Realizadas</div>
                        <div class="funnel-value">${totalCallRealizada}</div>
                        <div class="funnel-percent">${totalAgendados > 0 ? ((totalCallRealizada / totalAgendados) * 100).toFixed(1) : 0}%</div>
                    </div>
                    <div class="funnel-arrow">‚Üì</div>
                    <div class="funnel-stage funnel-stage-5">
                        <div class="funnel-label">üíº Vendas</div>
                        <div class="funnel-value">${totalVendas}</div>
                        <div class="funnel-percent">${totalCallRealizada > 0 ? ((totalVendas / totalCallRealizada) * 100).toFixed(1) : 0}%</div>
                    </div>
                </div>
            `;
        }

        function updateChart() {
            // ... mesmo c√≥digo ...
            if (chartInstance) chartInstance.destroy();
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: { labels, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { font: { size: 18 }, color: '#e2e8f0' } },
                        tooltip: { titleFont: { size: 18 }, bodyFont: { size: 16 } }
                    },
                    scales: {
                        y: { ticks: { font: { size: 16 }, color: '#e2e8f0' } },
                        x: { ticks: { font: { size: 16 }, color: '#e2e8f0' } }
                    },
                    elements: { line: { borderWidth: 4 }, point: { radius: 6 } }
                }
            });
        }

        // ... resto do JS ...
        loadData();
    </script>
</body>
</html>
