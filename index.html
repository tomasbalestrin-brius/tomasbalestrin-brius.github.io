<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acompanhamento Geral Funis - An√°lise Completa</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            min-height: 100vh;
            color: white;
            padding: 30px 20px;
        }

        /* Tooltips Informativos Ricos */
        .info-tooltip {
            position: relative;
            display: inline-flex;
            align-items: center;
            cursor: help;
        }

        .info-tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            margin-left: 6px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 50%;
            font-size: 0.7rem;
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.3);
            transition: all 0.3s;
        }

        .info-tooltip:hover .info-tooltip-icon {
            background: rgba(59, 130, 246, 0.4);
            transform: scale(1.2);
        }

        .info-tooltip-content {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 16px;
            min-width: 280px;
            max-width: 350px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 1000;
            pointer-events: none;
        }

        .info-tooltip:hover .info-tooltip-content {
            opacity: 1;
            visibility: visible;
            bottom: calc(100% + 15px);
        }

        .info-tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: #3b82f6;
        }

        .tooltip-title {
            font-size: 1rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tooltip-description {
            font-size: 0.85rem;
            color: #cbd5e1;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .tooltip-formula {
            background: #0f172a;
            padding: 10px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #94a3b8;
            margin: 8px 0;
            border-left: 3px solid #3b82f6;
        }

        .tooltip-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #60a5fa;
            margin-top: 8px;
        }

        .tooltip-value.positive {
            color: #10b981;
        }

        .tooltip-value.negative {
            color: #ef4444;
        }

        /* Loading Skeletons */
        .skeleton {
            background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
            background-size: 200% 100%;
            animation: loading 1.5s ease-in-out infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        .skeleton-card {
            background: #1e293b;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #475569;
        }

        .skeleton-title {
            height: 24px;
            width: 60%;
            margin-bottom: 15px;
        }

        .skeleton-text {
            height: 16px;
            width: 100%;
            margin-bottom: 10px;
        }

        .skeleton-text.short {
            width: 70%;
        }

        .skeleton-value {
            height: 32px;
            width: 50%;
            margin-top: 15px;
        }

        /* Micro-intera√ß√µes */
        .btn-interactive {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-interactive::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-interactive:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-interactive:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .btn-interactive:active {
            transform: translateY(0);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .card-interactive {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-interactive:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        .pulse-animation {
            animation: pulse-subtle 2s ease-in-out infinite;
        }

        @keyframes pulse-subtle {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.9;
            }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .toast {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 16px 20px;
            min-width: 300px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease-out;
            pointer-events: all;
        }

        .toast.success {
            border-color: #10b981;
        }

        .toast.error {
            border-color: #ef4444;
        }

        .toast.warning {
            border-color: #f59e0b;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .toast.removing {
            animation: slideOutRight 0.3s ease-in;
        }

        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 0.85rem;
            color: #cbd5e1;
        }

        /* Estados Vazios */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            text-align: center;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-radius: 16px;
            border: 2px dashed #475569;
            min-height: 400px;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .empty-state-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 12px;
        }

        .empty-state-description {
            font-size: 1.05rem;
            color: #94a3b8;
            margin-bottom: 25px;
            max-width: 500px;
            line-height: 1.6;
        }

        .empty-state-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .empty-state-btn {
            padding: 12px 24px;
            border-radius: 8px;
            border: 2px solid #3b82f6;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .empty-state-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .empty-state-btn.secondary {
            background: transparent;
            color: #94a3b8;
        }

        .empty-state-btn.secondary:hover {
            color: #e2e8f0;
            border-color: #60a5fa;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .left-sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 80px;
            background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
            border-right: 2px solid #334155;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            gap: 15px;
            z-index: 1000;
            box-shadow: 5px 0 20px rgba(0, 0, 0, 0.5);
        }

        .sidebar-btn {
            width: 60px;
            height: 60px;
            border: none;
            border-radius: 12px;
            background: #1e293b;
            color: #94a3b8;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .sidebar-btn:hover {
            background: #334155;
            color: #e2e8f0;
            transform: scale(1.1);
        }

        .sidebar-btn.active {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(59, 130, 246, 0.4);
        }

        .sidebar-btn .tooltip {
            position: absolute;
            left: 75px;
            background: #1e293b;
            color: #e2e8f0;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            border: 1px solid #475569;
            z-index: 1001;
        }

        .sidebar-btn:hover .tooltip {
            opacity: 1;
        }

        .main-content {
            margin-left: 100px;
        }

        .module-view {
            display: none;
        }

        .module-view.active {
            display: block;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .product-selector-comparison {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
            padding: 30px;
            background: #1e293b;
            border-radius: 16px;
            border: 2px solid #475569;
        }

        .product-select-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .product-select-label {
            color: #94a3b8;
            font-size: 1.1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .product-selector-comparison select {
            padding: 15px 25px;
            border-radius: 10px;
            border: 2px solid #475569;
            background: #0f172a;
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 200px;
        }

        .product-selector-comparison select:hover {
            border-color: #3b82f6;
            transform: scale(1.05);
        }

        .product-selector-comparison select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }

        .comparison-vs {
            font-size: 2rem;
            font-weight: 900;
            color: #f59e0b;
            text-shadow: 0 0 20px rgba(245, 158, 11, 0.5);
            padding: 0 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .comparison-side {
            background: #1e293b;
            border-radius: 16px;
            padding: 25px;
            border: 2px solid #475569;
        }

        .comparison-side.winner {
            border-color: #10b981;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.3);
        }

        .comparison-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #334155;
        }

        .comparison-header-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #e2e8f0;
            margin-bottom: 5px;
        }

        .comparison-header-subtitle {
            font-size: 1rem;
            color: #94a3b8;
        }

        .comparison-winner-badge {
            display: inline-block;
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 700;
            margin-top: 10px;
        }

        .comparison-funnel-mini {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }

        .comparison-stage {
            background: #0f172a;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
        }

        .comparison-stage-label {
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 5px;
        }

        .comparison-stage-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #e2e8f0;
        }

        .comparison-stage-percent {
            font-size: 0.9rem;
            color: #60a5fa;
            margin-top: 3px;
        }

        .comparison-metrics {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comparison-metric {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .comparison-metric-label {
            font-size: 0.95rem;
            color: #94a3b8;
            font-weight: 600;
        }

        .comparison-metric-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e2e8f0;
        }

        .comparison-metric-value.positive {
            color: #10b981;
        }

        .comparison-metric-value.negative {
            color: #ef4444;
        }

        .comparison-analysis {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
            padding: 25px;
            border-radius: 16px;
            margin-top: 30px;
            border: 2px solid #3b82f6;
        }

        .comparison-analysis-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-analysis-content {
            font-size: 1.05rem;
            color: #cbd5e1;
            line-height: 1.8;
        }

        .comparison-analysis-content strong {
            color: #60a5fa;
        }

        .comparison-column {
            background: #1e293b;
            padding: 25px;
            border-radius: 16px;
            border: 2px solid #475569;
        }

        .comparison-column.winner {
            border-color: #10b981;
            box-shadow: 0 10px 40px rgba(16, 185, 129, 0.3);
        }

        .comparison-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #475569;
        }

        .comparison-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .comparison-subtitle {
            font-size: 1rem;
            color: #94a3b8;
        }

        .comparison-metrics {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comparison-metric {
            background: #0f172a;
            padding: 18px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .comparison-metric-label {
            color: #94a3b8;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .comparison-metric-value {
            color: #e2e8f0;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .comparison-diff {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 20px;
            background: #0f172a;
            border-radius: 12px;
            margin-top: 20px;
        }

        .comparison-diff-arrow {
            font-size: 2.5rem;
        }

        .comparison-diff-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .comparison-diff-value.positive {
            color: #10b981;
        }

        .comparison-diff-value.negative {
            color: #ef4444;
        }

        .comparison-winner-badge {
            display: inline-block;
            padding: 8px 20px;
            background: linear-gradient(45deg, #10b981, #34d399);
            border-radius: 20px;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .funnel-comparison {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin-bottom: 30px;
        }

        .funnel-comparison-side {
            background: #1e293b;
            padding: 20px;
            border-radius: 12px;
        }

        .funnel-comparison-middle {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
        }

        .comparison-vs {
            font-size: 2rem;
            font-weight: 800;
            color: #3b82f6;
            text-align: center;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        .product-selector-comparison {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #1e293b;
            border-radius: 12px;
        }

        .product-select-wrapper {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .product-select-label {
            color: #94a3b8;
            font-size: 1rem;
            font-weight: 600;
        }

        .product-select-wrapper select {
            padding: 12px 24px;
            border-radius: 8px;
            border: 2px solid #475569;
            background: #0f172a;
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 200px;
        }

        .product-select-wrapper select:hover {
            border-color: #3b82f6;
        }

        .product-select-wrapper select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .comparison-insights {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            margin-top: 30px;
        }

        .comparison-insights-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-insights-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .comparison-insight-item {
            color: #94a3b8;
            font-size: 1rem;
            padding: 12px;
            background: #0f172a;
            border-radius: 8px;
            display: flex;
            align-items: start;
            gap: 10px;
        }

        .comparison-insight-icon {
            font-size: 1.3rem;
            min-width: 30px;
        }

        .comparison-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #1e293b;
            border-radius: 12px;
        }

        .comparison-label {
            color: #94a3b8;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-selector select {
            padding: 10px 20px;
            border-radius: 8px;
            border: 2px solid #475569;
            background: #0f172a;
            color: #e2e8f0;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .comparison-selector select:hover {
            border-color: #3b82f6;
        }

        .comparison-selector select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .roi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .roi-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            padding: 30px;
            border-radius: 16px;
            border: 2px solid #475569;
            transition: all 0.3s;
        }

        .roi-card:hover {
            border-color: #3b82f6;
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.3);
        }

        .roi-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .roi-card-icon {
            font-size: 2.5rem;
        }

        .roi-card-title {
            font-size: 1.1rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .roi-card-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .roi-card-subtitle {
            font-size: 0.9rem;
            color: #64748b;
        }

        .insights-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .insight-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            display: flex;
            gap: 20px;
            align-items: start;
            transition: all 0.3s;
        }

        .insight-card:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .insight-card.success {
            border-left-color: #10b981;
        }

        .insight-card.warning {
            border-left-color: #f59e0b;
        }

        .insight-card.danger {
            border-left-color: #ef4444;
        }

        .insight-icon {
            font-size: 2rem;
            min-width: 50px;
            text-align: center;
        }

        .insight-content {
            flex: 1;
        }

        .insight-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 8px;
        }

        .insight-description {
            font-size: 1rem;
            color: #94a3b8;
            line-height: 1.6;
        }

        .export-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .export-btn {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #475569;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .export-btn:hover {
            border-color: #3b82f6;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .export-btn-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .export-btn-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 8px;
        }

        .export-btn-description {
            font-size: 0.9rem;
            color: #94a3b8;
        }

        .fullscreen-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.5);
            transition: all 0.3s;
            z-index: 999;
        }

        .fullscreen-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(59, 130, 246, 0.6);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
        }

        .header h1 {
            font-size: 3.5rem;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            font-weight: 800;
            text-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
            filter: drop-shadow(0 0 20px rgba(139, 92, 246, 0.4));
        }

        .header p {
            font-size: 1.2rem;
            color: #94a3b8;
            margin-bottom: 10px;
        }

        .month-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .month-btn {
            padding: 16px 35px;
            border: 2px solid #475569;
            border-radius: 10px;
            background: #1e293b;
            color: #e2e8f0;
            font-size: 1.15rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .month-btn:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }

        .month-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }

        .team-selector {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 35px;
        }

        .team-btn {
            padding: 25px 60px;
            border: 3px solid #475569;
            border-radius: 16px;
            font-size: 1.5rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            background: #1e293b;
            color: #e2e8f0;
        }

        .team-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }

        .team-btn.active {
            background: linear-gradient(45deg, #8b5cf6, #a855f7);
            border-color: #8b5cf6;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);
        }

        .team-btn.geral-btn {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-color: #3b82f6;
        }

        .team-btn.geral-btn.active {
            background: linear-gradient(45deg, #3b82f6, #60a5fa);
            border-color: #3b82f6;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.5);
        }

        .product-selector {
            display: flex;
            justify-content: center;
            gap: 18px;
            margin-bottom: 35px;
            flex-wrap: wrap;
        }

        .product-btn {
            padding: 18px 38px;
            border: none;
            border-radius: 14px;
            font-size: 1.15rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            background: #334155;
            color: #e2e8f0;
        }

        .product-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .product-btn.active {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .dashboard-content {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 20px;
            margin-bottom: 30px;
        }

        .main-chart {
            background: #1e293b;
            border-radius: 16px;
            padding: 18px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .chart-title {
            font-size: 1.15rem;
            color: #e2e8f0;
        }

        .week-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .week-selector label {
            color: #94a3b8;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .week-selector select {
            padding: 6px 12px;
            border-radius: 6px;
            border: 2px solid #475569;
            background: #0f172a;
            color: #e2e8f0;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .week-selector select:hover {
            border-color: #3b82f6;
        }

        .week-selector select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        /* Estilo do Funil */
        .funnel-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 12px 0;
        }

        .funnel-stage {
            width: 100%;
            text-align: center;
            padding: 14px;
            border-radius: 8px;
            position: relative;
            transition: all 0.3s;
            cursor: pointer;
        }

        .funnel-stage:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .funnel-stage-1 {
            width: 100%;
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        }

        .funnel-stage-2 {
            width: 85%;
            background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);
        }

        .funnel-stage-3 {
            width: 70%;
            background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
        }

        .funnel-stage-4 {
            width: 55%;
            background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%);
        }

        .funnel-stage-5 {
            width: 40%;
            background: linear-gradient(135deg, #c026d3 0%, #d946ef 100%);
        }

        .funnel-label {
            font-size: 1.05rem;
            opacity: 0.95;
            margin-bottom: 6px;
            font-weight: 700;
        }

        .funnel-value {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 6px;
        }

        .funnel-percent {
            font-size: 1.15rem;
            opacity: 0.95;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-weight: 600;
        }

        .funnel-percent-label {
            font-size: 0.9rem;
            opacity: 0.85;
            font-style: italic;
            font-weight: 500;
        }

        .funnel-arrow {
            font-size: 1.5rem;
            color: #94a3b8;
            margin: -6px 0;
        }

        .stats-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .stat-card {
            background: #1e293b;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 1.6rem;
            font-weight: bold;
            color: #e2e8f0;
        }

        .stat-value.positive {
            color: #10b981;
        }

        .stat-value.negative {
            color: #ef4444;
        }

        .stats-block {
            background: #1e293b;
            padding: 32px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            margin-bottom: 18px;
        }

        .stats-block.aquisicao {
            border-left-color: #8b5cf6;
        }

        .stats-block.monetizacao {
            border-left-color: #10b981;
        }

        .stats-block.tendencia {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            border-left-width: 3px;
            border-style: dashed;
            padding: 26px;
            opacity: 0.95;
        }

        .stats-block.tendencia.aquisicao {
            border-left-color: #a78bfa;
        }

        .stats-block.tendencia.monetizacao {
            border-left-color: #34d399;
        }

        .stats-block-title {
            font-size: 1.6rem;
            font-weight: 800;
            color: #e2e8f0;
            margin-bottom: 22px;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stats-block.tendencia .stats-block-title {
            font-size: 1.3rem;
            color: #cbd5e1;
            margin-bottom: 18px;
        }

        .stats-block-title::before {
            content: '{';
            font-size: 3.2rem;
            color: #3b82f6;
            line-height: 1;
        }

        .stats-block.tendencia .stats-block-title::before {
            content: '‚Üó';
            font-size: 2.5rem;
            opacity: 0.7;
        }

        .stats-block.aquisicao .stats-block-title::before {
            color: #8b5cf6;
        }

        .stats-block.monetizacao .stats-block-title::before {
            color: #10b981;
        }

        .stats-block.tendencia.aquisicao .stats-block-title::before {
            color: #a78bfa;
        }

        .stats-block.tendencia.monetizacao .stats-block-title::before {
            color: #34d399;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 0;
            border-bottom: 1px solid #334155;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stats-block.tendencia .stat-item {
            padding: 14px 0;
        }

        .stat-item-label {
            color: #94a3b8;
            font-size: 1.15rem;
            font-weight: 600;
        }

        .stats-block.tendencia .stat-item-label {
            font-size: 1.05rem;
            color: #94a3b8;
        }

        .stat-item-value {
            color: #e2e8f0;
            font-size: 1.6rem;
            font-weight: 800;
        }

        .stats-block.tendencia .stat-item-value {
            font-size: 1.3rem;
            color: #cbd5e1;
            font-weight: 700;
        }

        .stat-item-value.positive {
            color: #10b981;
        }

        .stat-item-value.negative {
            color: #ef4444;
        }

        .bottom-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .bottom-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #475569;
            transition: all 0.3s;
        }

        .bottom-card:hover {
            border-color: #3b82f6;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .bottom-card.tendencia {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
            border: 2px dashed #3b82f6;
        }

        .bottom-card.tendencia:hover {
            border-color: #60a5fa;
            box-shadow: 0 10px 30px rgba(96, 165, 250, 0.4);
        }

        .bottom-card-icon {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .bottom-card-label {
            color: #94a3b8;
            font-size: 0.8rem;
            margin-bottom: 6px;
            text-transform: uppercase;
        }

        .bottom-card-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: #e2e8f0;
        }

        .ranking-section {
            background: #1e293b;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }

        .ranking-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            text-align: center;
            color: #e2e8f0;
        }

        .ranking-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .ranking-card {
            background: linear-gradient(135deg, #334155 0%, #1e293b 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #475569;
            transition: all 0.3s;
        }

        .ranking-card:hover {
            border-color: #3b82f6;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .ranking-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .ranking-label {
            color: #94a3b8;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .ranking-product {
            font-size: 1.3rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 5px;
        }

        .ranking-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #3b82f6;
        }

        @media (max-width: 1200px) {
            .dashboard-content {
                grid-template-columns: 1fr;
            }
            .stats-panel {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            }
            .bottom-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            .comparison-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }
        }

        @media (max-width: 768px) {
            .left-sidebar {
                width: 60px;
                padding: 15px 0;
            }
            
            .sidebar-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .sidebar-btn .tooltip {
                display: none;
            }
            
            .main-content {
                margin-left: 70px;
            }
            
            .container {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .month-btn {
                padding: 14px 28px;
                font-size: 1rem;
            }
            
            .team-selector {
                flex-wrap: wrap;
            }
            
            .team-btn {
                padding: 20px 40px;
                font-size: 1.2rem;
            }
            
            .product-btn {
                padding: 15px 30px;
                font-size: 1rem;
            }
            
            .bottom-cards {
                grid-template-columns: 1fr;
            }
            
            .export-buttons {
                grid-template-columns: 1fr;
            }
            
            .roi-grid {
                grid-template-columns: 1fr;
            }
            
            .product-selector-comparison {
                flex-direction: column;
                gap: 20px;
            }
            
            .comparison-vs {
                transform: rotate(90deg);
                font-size: 1.5rem;
            }
            
            .comparison-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .team-selector {
                flex-direction: column;
                gap: 15px;
            }
            
            .team-btn {
                width: 100%;
                max-width: 300px;
                margin: 0 auto;
            }
            
            .left-sidebar {
                width: 50px;
            }
            
            .sidebar-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .main-content {
                margin-left: 60px;
            }
        }
    </style>
</head>
<body>
    <!-- Barra Lateral Esquerda -->
    <div class="left-sidebar">
        <button class="sidebar-btn active" onclick="showModule('dashboard')" data-module="dashboard">
            <span>üè†</span>
            <span class="tooltip">Dashboard Principal</span>
        </button>
        <button class="sidebar-btn" onclick="showModule('comparar-funis')" data-module="comparar-funis">
            <span>‚öîÔ∏è</span>
            <span class="tooltip">Comparar Funis</span>
        </button>
        <button class="sidebar-btn" onclick="showModule('comparacao')" data-module="comparacao">
            <span>üìÖ</span>
            <span class="tooltip">Comparar Meses</span>
        </button>
        <button class="sidebar-btn" onclick="showModule('roi')" data-module="roi">
            <span>üí∞</span>
            <span class="tooltip">Lucro e ROAS</span>
        </button>
        <button class="sidebar-btn" onclick="showModule('custos')" data-module="custos">
            <span>üìä</span>
            <span class="tooltip">Custo por Lead</span>
        </button>
        <button class="sidebar-btn" onclick="showModule('insights')" data-module="insights">
            <span>ü§ñ</span>
            <span class="tooltip">Insights Autom√°ticos</span>
        </button>
        <button class="sidebar-btn" onclick="showModule('exportar')" data-module="exportar">
            <span>üì•</span>
            <span class="tooltip">Exportar</span>
        </button>
    </div>

    <div class="main-content">
    <div class="container">
        <!-- M√ìDULO: Dashboard Principal -->
        <div class="module-view active" id="module-dashboard">
        <div class="header">
            <h1>üìä ACOMPANHAMENTO GERAL FUNIS</h1>
            <p>An√°lise Completa de Performance por Produto</p>
        </div>

        <div class="month-selector" id="monthSelector"></div>

        <div class="team-selector">
            <button class="team-btn geral-btn active" onclick="selectTeam('geral')">
                üìä GERAL
            </button>
            <button class="team-btn" onclick="selectTeam('cleiton')">
                üë®‚Äçüíº CLEITON
            </button>
            <button class="team-btn" onclick="selectTeam('julia')">
                üë©‚Äçüíº JULIA
            </button>
        </div>

        <div class="product-selector" id="productSelector"></div>

        <div class="dashboard-content">
            <div class="main-chart">
                <div class="chart-header">
                    <h2 class="chart-title" id="chartTitle">Funil de Convers√£o</h2>
                    <div class="week-selector">
                        <label for="weekSelect">üìÖ Per√≠odo:</label>
                        <select id="weekSelect" onchange="updateFunnel()">
                            <option value="total">Total do M√™s</option>
                            <option value="1">Semana 1</option>
                            <option value="2">Semana 2</option>
                            <option value="3">Semana 3</option>
                            <option value="4">Semana 4</option>
                        </select>
                    </div>
                </div>
                <div id="funnelArea"></div>
            </div>

            <div class="stats-panel" id="statsPanel"></div>
        </div>

        <div class="bottom-cards" id="bottomCards"></div>

        <div class="ranking-section">
            <h2 class="ranking-title">üèÜ RANKING DE PRODUTOS - COMPARA√á√ÉO</h2>
            <div class="ranking-grid" id="rankingGrid"></div>
        </div>
        </div>

        <!-- M√ìDULO: ROI/ROAS -->
        <div class="module-view" id="module-roi">
            <div class="header">
                <h1>üí∞ AN√ÅLISE DE LUCRO E ROAS</h1>
                <p>Lucro Absoluto e Retorno sobre Investimento</p>
            </div>
            <div class="month-selector" id="monthSelectorROI"></div>
            <div class="roi-grid" id="roiGrid"></div>
        </div>

        <!-- M√ìDULO: Custo por Lead -->
        <div class="module-view" id="module-custos">
            <div class="header">
                <h1>üìä CUSTO POR LEAD/VENDA</h1>
                <p>An√°lise de CAC e Efici√™ncia</p>
            </div>
            <div class="month-selector" id="monthSelectorCustos"></div>
            <div class="roi-grid" id="custosGrid"></div>
        </div>

        <!-- M√ìDULO: Insights -->
        <div class="module-view" id="module-insights">
            <div class="header">
                <h1>ü§ñ INSIGHTS AUTOM√ÅTICOS</h1>
                <p>An√°lise Inteligente dos Dados</p>
            </div>
            <div class="month-selector" id="monthSelectorInsights"></div>
            <div class="insights-container" id="insightsContainer"></div>
        </div>

        <!-- M√ìDULO: Comparar Funis -->
        <div class="module-view" id="module-comparar-funis">
            <div class="header">
                <h1>‚öñÔ∏è COMPARA√á√ÉO ENTRE FUNIS</h1>
                <p>Compare a Performance de Dois Produtos Lado a Lado</p>
            </div>
            
            <div class="month-selector" id="monthSelectorComparacaoFunis"></div>
            
            <div class="product-selector-comparison">
                <div class="product-select-wrapper">
                    <span class="product-select-label">üéØ Funil 1:</span>
                    <select id="funil1Select" onchange="updateFunilComparison()">
                        <option value="50 Scripts">üî• 50 Scripts</option>
                        <option value="Teste">üß™ Teste</option>
                        <option value="IA Julia">ü§ñ IA Julia</option>
                        <option value="MPM">üì± MPM</option>
                        <option value="Couply">üíë Couply</option>
                    </select>
                </div>
                <div class="comparison-vs">VS</div>
                <div class="product-select-wrapper">
                    <span class="product-select-label">üéØ Funil 2:</span>
                    <select id="funil2Select" onchange="updateFunilComparison()">
                        <option value="50 Scripts">üî• 50 Scripts</option>
                        <option value="Teste" selected>üß™ Teste</option>
                        <option value="IA Julia">ü§ñ IA Julia</option>
                        <option value="MPM">üì± MPM</option>
                        <option value="Couply">üíë Couply</option>
                    </select>
                </div>
            </div>

            <div id="funilComparisonContent"></div>
        </div>

        <!-- M√ìDULO: Compara√ß√£o de Meses -->
        <div class="module-view" id="module-comparacao">
            <div class="header">
                <h1>üìÖ COMPARA√á√ÉO ENTRE MESES</h1>
                <p>An√°lise Comparativa de Performance Entre Per√≠odos</p>
            </div>
            
            <div class="product-selector-comparison">
                <div class="product-select-wrapper">
                    <span class="product-select-label">üìÖ M√™s 1:</span>
                    <select id="month1Select" onchange="updateMonthComparison()">
                        <option value="out">Outubro</option>
                        <option value="nov" selected>Novembro</option>
                        <option value="dez">Dezembro</option>
                        <option value="jan">Janeiro</option>
                        <option value="fev">Fevereiro</option>
                    </select>
                </div>
                <div class="comparison-vs">VS</div>
                <div class="product-select-wrapper">
                    <span class="product-select-label">üìÖ M√™s 2:</span>
                    <select id="month2Select" onchange="updateMonthComparison()">
                        <option value="out" selected>Outubro</option>
                        <option value="nov">Novembro</option>
                        <option value="dez">Dezembro</option>
                        <option value="jan">Janeiro</option>
                        <option value="fev">Fevereiro</option>
                    </select>
                </div>
            </div>

            <div id="monthComparisonContent"></div>
        </div>

        <!-- M√ìDULO: Exportar -->
        <div class="module-view" id="module-exportar">
            <div class="header">
                <h1>üì• EXPORTAR DADOS</h1>
                <p>Baixe seus relat√≥rios e compartilhe insights</p>
            </div>
            <div class="export-buttons">
                <div class="export-btn" onclick="exportPDF()">
                    <div class="export-btn-icon">üìÑ</div>
                    <div class="export-btn-title">Exportar PDF</div>
                    <div class="export-btn-description">Relat√≥rio completo em PDF</div>
                </div>
                <div class="export-btn" onclick="exportExcel()">
                    <div class="export-btn-icon">üìä</div>
                    <div class="export-btn-title">Exportar Excel</div>
                    <div class="export-btn-description">Planilha com todos os dados</div>
                </div>
                <div class="export-btn" onclick="exportCSV()">
                    <div class="export-btn-icon">üìã</div>
                    <div class="export-btn-title">Exportar CSV</div>
                    <div class="export-btn-description">Dados em formato CSV</div>
                </div>
                <div class="export-btn" onclick="shareLink()">
                    <div class="export-btn-icon">üîó</div>
                    <div class="export-btn-title">Compartilhar Link</div>
                    <div class="export-btn-description">Gerar link compartilh√°vel</div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- Bot√£o de Modo Apresenta√ß√£o -->
    <button class="fullscreen-btn" onclick="toggleFullscreen()" title="Modo Apresenta√ß√£o">
        üñ•Ô∏è
    </button>

    <script>
        // ===================================
        // FUN√á√ïES DE UX/UI
        // ===================================

        // Sistema de Toast Notifications
        function showToast(message, type = 'info', duration = 3000) {
            const container = document.getElementById('toastContainer');
            if (!container) {
                const newContainer = document.createElement('div');
                newContainer.id = 'toastContainer';
                newContainer.className = 'toast-container';
                document.body.appendChild(newContainer);
            }
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${icons[type] || icons.info}</div>
                <div class="toast-content">
                    <div class="toast-message">${message}</div>
                </div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('removing');
                setTimeout(() => toast.remove(), 300);
            }, duration);
        }

        // Loading Skeleton para cards
        function createSkeleton(type = 'card') {
            if (type === 'card') {
                return `
                    <div class="skeleton-card">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text short"></div>
                        <div class="skeleton skeleton-value"></div>
                    </div>
                `;
            }
            return '<div class="skeleton" style="height: 200px; width: 100%;"></div>';
        }

        // Mostrar loading skeleton em um container
        function showLoadingSkeleton(containerId, count = 3) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let html = '';
            for (let i = 0; i < count; i++) {
                html += createSkeleton('card');
            }
            container.innerHTML = html;
        }

        // Estado vazio gen√©rico
        function showEmptyState(containerId, options = {}) {
            const {
                icon = 'üìä',
                title = 'Nenhum dado dispon√≠vel',
                description = 'N√£o h√° informa√ß√µes para exibir neste momento.',
                primaryAction = null,
                secondaryAction = null
            } = options;
            
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let actionsHtml = '';
            if (primaryAction || secondaryAction) {
                actionsHtml = '<div class="empty-state-actions">';
                if (primaryAction) {
                    actionsHtml += `<button class="empty-state-btn" onclick="${primaryAction.onClick}">${primaryAction.label}</button>`;
                }
                if (secondaryAction) {
                    actionsHtml += `<button class="empty-state-btn secondary" onclick="${secondaryAction.onClick}">${secondaryAction.label}</button>`;
                }
                actionsHtml += '</div>';
            }
            
            container.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon">${icon}</div>
                    <div class="empty-state-title">${title}</div>
                    <div class="empty-state-description">${description}</div>
                    ${actionsHtml}
                </div>
            `;
        }

        // Criar tooltip informativo
        function createTooltip(label, content) {
            const { title, description, formula, value, valueClass } = content;
            
            return `
                <span class="info-tooltip">
                    ${label}
                    <span class="info-tooltip-icon">?</span>
                    <div class="info-tooltip-content">
                        <div class="tooltip-title">${title}</div>
                        <div class="tooltip-description">${description}</div>
                        ${formula ? `<div class="tooltip-formula">${formula}</div>` : ''}
                        ${value ? `<div class="tooltip-value ${valueClass || ''}">${value}</div>` : ''}
                    </div>
                </span>
            `;
        }

        // Adicionar micro-intera√ß√µes a elementos
        function addMicroInteractions() {
            // Adicionar classe aos bot√µes
            document.querySelectorAll('.month-btn, .team-btn, .product-btn, .sidebar-btn').forEach(btn => {
                if (!btn.classList.contains('btn-interactive')) {
                    btn.classList.add('btn-interactive');
                }
            });
            
            // Adicionar classe aos cards
            document.querySelectorAll('.bottom-card, .ranking-card, .roi-card').forEach(card => {
                if (!card.classList.contains('card-interactive')) {
                    card.classList.add('card-interactive');
                }
            });
        }

        // Defini√ß√µes de tooltips para m√©tricas
        const tooltipDefinitions = {
            roi: {
                title: 'üìà ROI (Return on Investment)',
                description: 'Retorno sobre Investimento - mede o lucro obtido em rela√ß√£o ao valor investido.',
                formula: 'ROI = ((Faturado - Investido) / Investido) √ó 100',
            },
            roas: {
                title: 'üéØ ROAS (Return on Ad Spend)',
                description: 'Retorno sobre Gastos com An√∫ncios - quanto voc√™ ganha para cada R$1 investido.',
                formula: 'ROAS = Faturado / Investido',
            },
            taxaConversao: {
                title: 'üíº Taxa de Convers√£o',
                description: 'Percentual de calls realizadas que resultaram em vendas.',
                formula: 'Taxa = (Vendas / Calls Realizadas) √ó 100',
            },
            taxaAgendamento: {
                title: 'üìÖ Taxa de Agendamento',
                description: 'Percentual de qualificados que agendaram uma call.',
                formula: 'Taxa = (Agendados / Qualificados) √ó 100',
            },
            taxaComparecimento: {
                title: 'üìû Taxa de Comparecimento',
                description: 'Percentual de calls agendadas que foram efetivamente realizadas.',
                formula: 'Taxa = (Realizadas / Agendadas) √ó 100',
            },
            cac: {
                title: 'üí∞ CAC (Custo de Aquisi√ß√£o)',
                description: 'Quanto voc√™ gasta para conquistar um novo cliente.',
                formula: 'CAC = Investimento Total / N√∫mero de Vendas',
            },
            lucro: {
                title: 'üìä Lucro',
                description: 'Diferen√ßa entre o faturamento e o investimento.',
                formula: 'Lucro = Faturamento - Investimento',
            }
        };

        // ===================================
        // FUN√á√ïES DE NAVEGA√á√ÉO ENTRE M√ìDULOS
        function showModule(moduleName) {
            // Oculta todos os m√≥dulos
            document.querySelectorAll('.module-view').forEach(module => {
                module.classList.remove('active');
            });
            
            // Mostra o m√≥dulo selecionado
            document.getElementById(`module-${moduleName}`).classList.add('active');
            
            // Atualiza bot√µes da sidebar
            document.querySelectorAll('.sidebar-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-module="${moduleName}"]`).classList.add('active');
            
            // Renderiza conte√∫do do m√≥dulo
            switch(moduleName) {
                case 'roi':
                    renderROI();
                    break;
                case 'custos':
                    renderCustos();
                    break;
                case 'insights':
                    renderInsights();
                    break;
                case 'comparar-funis':
                    renderMonthSelectorForModule('monthSelectorComparacaoFunis');
                    updateFunilComparison();
                    break;
                case 'comparacao':
                    updateMonthComparison();
                    break;
            }
        }

        // FUN√á√ïES DO M√ìDULO ROI/ROAS
        function renderROI() {
            renderMonthSelectorForModule('monthSelectorROI');
            const container = document.getElementById('roiGrid');
            
            const produtos = allProducts.filter(p => p.id !== 'Geral');
            
            let html = '';
            produtos.forEach(product => {
                const data = allData[product.id];
                if (!data) return;
                
                const { semanas } = data;
                const totalInvestido = semanas.reduce((sum, s) => sum + s.investido, 0);
                const totalFaturamentoTrafego = semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0);
                const totalFaturamentoFunil = semanas.reduce((sum, s) => sum + s.faturamentoFunil, 0);
                
                const lucroAbsoluto = totalFaturamentoTrafego - totalInvestido;
                const roas = totalInvestido > 0 ? (totalFaturamentoTrafego / totalInvestido) : 0;
                const roasFunil = totalInvestido > 0 ? (totalFaturamentoFunil / totalInvestido) : 0;
                
                html += `
                    <div class="roi-card">
                        <div class="roi-card-header">
                            <div class="roi-card-icon">${product.icon}</div>
                            <div class="roi-card-title">${product.name}</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div class="roi-card-value" style="color: ${lucroAbsoluto >= 0 ? '#10b981' : '#ef4444'}">
                                ${lucroAbsoluto >= 0 ? '+' : ''}R$ ${Math.abs(lucroAbsoluto).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </div>
                            <div class="roi-card-subtitle">Lucro / Preju√≠zo</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <div class="roi-card-value" style="font-size: 2rem; color: #60a5fa;">
                                ${roas.toFixed(2)}x
                            </div>
                            <div class="roi-card-subtitle">ROAS Tr√°fego</div>
                        </div>
                        <div>
                            <div class="roi-card-value" style="font-size: 2rem; color: #a78bfa;">
                                ${roasFunil.toFixed(2)}x
                            </div>
                            <div class="roi-card-subtitle">ROAS Funil</div>
                        </div>
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #475569;">
                            <div style="font-size: 0.9rem; color: #94a3b8;">
                                Investido: <strong>R$ ${totalInvestido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</strong><br>
                                Retorno: <strong>R$ ${totalFaturamentoTrafego.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</strong>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // FUN√á√ïES DO M√ìDULO CUSTOS
        function renderCustos() {
            renderMonthSelectorForModule('monthSelectorCustos');
            const container = document.getElementById('custosGrid');
            
            const produtos = allProducts.filter(p => p.id !== 'Geral');
            
            let html = '';
            produtos.forEach(product => {
                const data = allData[product.id];
                if (!data) return;
                
                const { semanas } = data;
                const totalInvestido = semanas.reduce((sum, s) => sum + s.investido, 0);
                const totalAlunos = semanas.reduce((sum, s) => sum + s.alunos, 0);
                const totalQualificados = semanas.reduce((sum, s) => sum + s.qualificados, 0);
                const totalAgendados = semanas.reduce((sum, s) => sum + s.agendados, 0);
                const totalVendas = semanas.reduce((sum, s) => sum + s.numeroVenda, 0);
                
                const custoAluno = totalAlunos > 0 ? totalInvestido / totalAlunos : 0;
                const custoQualificado = totalQualificados > 0 ? totalInvestido / totalQualificados : 0;
                const custoAgendado = totalAgendados > 0 ? totalInvestido / totalAgendados : 0;
                const custoVenda = totalVendas > 0 ? totalInvestido / totalVendas : 0;
                
                html += `
                    <div class="roi-card">
                        <div class="roi-card-header">
                            <div class="roi-card-icon">${product.icon}</div>
                            <div class="roi-card-title">${product.name}</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div class="roi-card-value" style="font-size: 1.8rem;">
                                R$ ${custoAluno.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </div>
                            <div class="roi-card-subtitle">üí∞ Custo por Aluno (${totalAlunos} alunos)</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div class="roi-card-value" style="font-size: 1.8rem;">
                                R$ ${custoQualificado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </div>
                            <div class="roi-card-subtitle">‚úÖ Custo por Qualificado (${totalQualificados})</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div class="roi-card-value" style="font-size: 1.8rem;">
                                R$ ${custoAgendado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </div>
                            <div class="roi-card-subtitle">üìÖ Custo por Agendado (${totalAgendados})</div>
                        </div>
                        <div>
                            <div class="roi-card-value" style="font-size: 2rem; color: #10b981;">
                                R$ ${custoVenda.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                            </div>
                            <div class="roi-card-subtitle">üíº CAC - Custo por Venda (${totalVendas})</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // FUN√á√ïES DO M√ìDULO INSIGHTS
        function renderInsights() {
            renderMonthSelectorForModule('monthSelectorInsights');
            const container = document.getElementById('insightsContainer');
            
            const insights = [];
            const produtos = allProducts.filter(p => p.id !== 'Geral');
            
            // Encontrar melhor e pior produto
            let melhorROI = { produto: '', valor: -Infinity };
            let piorROI = { produto: '', valor: Infinity };
            let melhorTaxaConversao = { produto: '', valor: -Infinity };
            
            produtos.forEach(product => {
                const data = allData[product.id];
                if (!data) return;
                
                const { semanas } = data;
                const totalInvestido = semanas.reduce((sum, s) => sum + s.investido, 0);
                const totalFaturado = semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0);
                const roi = totalInvestido > 0 ? ((totalFaturado - totalInvestido) / totalInvestido * 100) : 0;
                const taxaConversaoMedia = semanas.reduce((sum, s) => sum + s.taxaConversao, 0) / semanas.length;
                
                if (roi > melhorROI.valor) {
                    melhorROI = { produto: product.name, valor: roi, icon: product.icon };
                }
                if (roi < piorROI.valor && roi < 0) {
                    piorROI = { produto: product.name, valor: roi, icon: product.icon };
                }
                if (taxaConversaoMedia > melhorTaxaConversao.valor) {
                    melhorTaxaConversao = { produto: product.name, valor: taxaConversaoMedia, icon: product.icon };
                }
            });
            
            // Insight 1: Melhor ROI
            if (melhorROI.valor > 0) {
                insights.push({
                    type: 'success',
                    icon: 'üéâ',
                    title: 'Melhor Performance de ROI',
                    description: `${melhorROI.icon} <strong>${melhorROI.produto}</strong> est√° com excelente ROI de <strong>${melhorROI.valor >= 0 ? '+' : ''}${melhorROI.valor.toFixed(2)}%</strong>! Este produto est√° gerando retorno positivo sobre o investimento.`
                });
            }
            
            // Insight 2: Produto com preju√≠zo
            if (piorROI.valor < 0) {
                insights.push({
                    type: 'danger',
                    icon: '‚ö†Ô∏è',
                    title: 'Aten√ß√£o: ROI Negativo',
                    description: `${piorROI.icon} <strong>${piorROI.produto}</strong> est√° com ROI negativo de <strong>${piorROI.valor.toFixed(2)}%</strong>. Considere revisar a estrat√©gia de investimento ou otimizar as campanhas.`
                });
            }
            
            // Insight 3: Melhor taxa de convers√£o
            if (melhorTaxaConversao.valor > 0) {
                insights.push({
                    type: 'success',
                    icon: '‚ú®',
                    title: 'Melhor Taxa de Convers√£o',
                    description: `${melhorTaxaConversao.icon} <strong>${melhorTaxaConversao.produto}</strong> tem a melhor taxa de convers√£o de <strong>${melhorTaxaConversao.valor.toFixed(2)}%</strong>. Use este produto como refer√™ncia para otimizar os outros funis.`
                });
            }
            
            // Insight 4: An√°lise geral do m√™s
            const geralData = allData['Geral'];
            if (geralData) {
                const totalInvestidoGeral = geralData.semanas.reduce((sum, s) => sum + s.investido, 0);
                const totalFaturadoGeral = geralData.semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0);
                const margemGeral = totalFaturadoGeral - totalInvestidoGeral;
                
                insights.push({
                    type: margemGeral >= 0 ? 'success' : 'warning',
                    icon: margemGeral >= 0 ? 'üìà' : 'üìä',
                    title: 'Performance Geral do M√™s',
                    description: `No total, foram investidos <strong>R$ ${totalInvestidoGeral.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</strong> e faturados <strong>R$ ${totalFaturadoGeral.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</strong>, resultando em uma margem de <strong>R$ ${margemGeral.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</strong>.`
                });
            }
            
            // Insight 5: Sugest√£o de foco
            insights.push({
                type: 'warning',
                icon: 'üéØ',
                title: 'Recomenda√ß√£o Estrat√©gica',
                description: `Baseado nos dados, recomendamos focar os esfor√ßos em produtos com ROI positivo e melhorar a taxa de agendamento dos produtos que est√£o com performance abaixo da m√©dia. Considere redistribuir o investimento para maximizar o retorno.`
            });
            
            let html = '';
            insights.forEach(insight => {
                html += `
                    <div class="insight-card ${insight.type}">
                        <div class="insight-icon">${insight.icon}</div>
                        <div class="insight-content">
                            <div class="insight-title">${insight.title}</div>
                            <div class="insight-description">${insight.description}</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // FUN√á√ïES DE COMPARA√á√ÉO DE FUNIS
        function renderFunilComparison() {
            renderMonthSelectorForModule('monthSelectorComparacaoFunis');
            updateFunilComparison();
        }

        function updateFunilComparison() {
            const funil1Id = document.getElementById('funil1Select').value;
            const funil2Id = document.getElementById('funil2Select').value;
            
            const data1 = allData[funil1Id];
            const data2 = allData[funil2Id];
            
            if (!data1 || !data2) return;
            
            const product1 = allProducts.find(p => p.id === funil1Id);
            const product2 = allProducts.find(p => p.id === funil2Id);
            
            // Calcular m√©tricas totais
            const metrics1 = calculateProductMetrics(data1);
            const metrics2 = calculateProductMetrics(data2);
            
            const container = document.getElementById('funilComparisonContent');
            
            // Determinar vencedor
            const winner = metrics1.roi > metrics2.roi ? 1 : 2;
            
            let html = `
                <!-- Funis Lado a Lado -->
                <div class="funnel-comparison">
                    <div class="funnel-comparison-side">
                        <div class="comparison-header">
                            <div class="comparison-title">${product1.icon} ${product1.name}</div>
                            ${winner === 1 ? '<div class="comparison-winner-badge">üèÜ VENCEDOR</div>' : ''}
                        </div>
                        ${renderMiniFunnel(metrics1)}
                    </div>
                    
                    <div class="funnel-comparison-middle">
                        <div class="comparison-vs">VS</div>
                    </div>
                    
                    <div class="funnel-comparison-side">
                        <div class="comparison-header">
                            <div class="comparison-title">${product2.icon} ${product2.name}</div>
                            ${winner === 2 ? '<div class="comparison-winner-badge">üèÜ VENCEDOR</div>' : ''}
                        </div>
                        ${renderMiniFunnel(metrics2)}
                    </div>
                </div>
                
                <!-- Compara√ß√£o de M√©tricas -->
                <div class="comparison-grid">
                    <div class="comparison-column ${winner === 1 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-title">${product1.icon} ${product1.name}</div>
                            <div class="comparison-subtitle">M√©tricas Principais</div>
                        </div>
                        <div class="comparison-metrics">
                            ${renderMetricComparison('üí∞ Investido', metrics1.totalInvestido, true)}
                            ${renderMetricComparison('üíµ Faturamento', metrics1.totalFaturamento, true)}
                            ${renderMetricComparison('üìä Lucro', metrics1.totalLucro, true)}
                            ${renderMetricComparison('üéØ ROI', metrics1.roi, false, '%')}
                            ${renderMetricComparison('üìà ROAS', metrics1.roas, false, 'x')}
                            ${renderMetricComparison('üë• Alunos', metrics1.totalAlunos, false)}
                            ${renderMetricComparison('‚úÖ Qualificados', metrics1.totalQualificados, false)}
                            ${renderMetricComparison('üìÖ Agendados', metrics1.totalAgendados, false)}
                            ${renderMetricComparison('üìû Calls', metrics1.totalCalls, false)}
                            ${renderMetricComparison('üíº Vendas', metrics1.totalVendas, false)}
                            ${renderMetricComparison('üìä Taxa Agendamento', metrics1.taxaAgendamento, false, '%')}
                            ${renderMetricComparison('üíº Taxa Convers√£o', metrics1.taxaConversao, false, '%')}
                        </div>
                    </div>
                    
                    <div class="comparison-column ${winner === 2 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-title">${product2.icon} ${product2.name}</div>
                            <div class="comparison-subtitle">M√©tricas Principais</div>
                        </div>
                        <div class="comparison-metrics">
                            ${renderMetricComparison('üí∞ Investido', metrics2.totalInvestido, true)}
                            ${renderMetricComparison('üíµ Faturamento', metrics2.totalFaturamento, true)}
                            ${renderMetricComparison('üìä Lucro', metrics2.totalLucro, true)}
                            ${renderMetricComparison('üéØ ROI', metrics2.roi, false, '%')}
                            ${renderMetricComparison('üìà ROAS', metrics2.roas, false, 'x')}
                            ${renderMetricComparison('üë• Alunos', metrics2.totalAlunos, false)}
                            ${renderMetricComparison('‚úÖ Qualificados', metrics2.totalQualificados, false)}
                            ${renderMetricComparison('üìÖ Agendados', metrics2.totalAgendados, false)}
                            ${renderMetricComparison('üìû Calls', metrics2.totalCalls, false)}
                            ${renderMetricComparison('üíº Vendas', metrics2.totalVendas, false)}
                            ${renderMetricComparison('üìä Taxa Agendamento', metrics2.taxaAgendamento, false, '%')}
                            ${renderMetricComparison('üíº Taxa Convers√£o', metrics2.taxaConversao, false, '%')}
                        </div>
                    </div>
                </div>
                
                <!-- Insights da Compara√ß√£o -->
                <div class="comparison-insights">
                    <div class="comparison-insights-title">
                        ü§ñ Insights da Compara√ß√£o
                    </div>
                    <div class="comparison-insights-list">
                        ${generateFunilInsights(product1, product2, metrics1, metrics2)}
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function calculateProductMetrics(data) {
            const { semanas } = data;
            
            return {
                totalInvestido: semanas.reduce((sum, s) => sum + s.investido, 0),
                totalFaturamento: semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0),
                totalLucro: semanas.reduce((sum, s) => sum + s.roasTrafego, 0),
                totalAlunos: semanas.reduce((sum, s) => sum + s.alunos, 0),
                totalQualificados: semanas.reduce((sum, s) => sum + s.qualificados, 0),
                totalAgendados: semanas.reduce((sum, s) => sum + s.agendados, 0),
                totalCalls: semanas.reduce((sum, s) => sum + s.callRealizada, 0),
                totalVendas: semanas.reduce((sum, s) => sum + s.numeroVenda, 0),
                taxaAgendamento: semanas.reduce((sum, s) => sum + s.taxaAgendamento, 0) / semanas.length,
                taxaConversao: semanas.reduce((sum, s) => sum + s.taxaConversao, 0) / semanas.length,
                roi: function() {
                    return this.totalInvestido > 0 ? ((this.totalFaturamento - this.totalInvestido) / this.totalInvestido * 100) : 0;
                }(),
                roas: function() {
                    return this.totalInvestido > 0 ? (this.totalFaturamento / this.totalInvestido) : 0;
                }()
            };
        }

        function renderMiniFunnel(metrics) {
            return `
                <div class="funnel-container" style="padding: 10px 0;">
                    <div class="funnel-stage funnel-stage-1" style="padding: 10px;">
                        <div class="funnel-label" style="font-size: 0.7rem;">üë• Alunos</div>
                        <div class="funnel-value" style="font-size: 1.2rem;">${metrics.totalAlunos}</div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-2" style="padding: 10px;">
                        <div class="funnel-label" style="font-size: 0.7rem;">‚úÖ Qualificados</div>
                        <div class="funnel-value" style="font-size: 1.2rem;">${metrics.totalQualificados}</div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-3" style="padding: 10px;">
                        <div class="funnel-label" style="font-size: 0.7rem;">üìÖ Agendados</div>
                        <div class="funnel-value" style="font-size: 1.2rem;">${metrics.totalAgendados}</div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-4" style="padding: 10px;">
                        <div class="funnel-label" style="font-size: 0.7rem;">üìû Calls</div>
                        <div class="funnel-value" style="font-size: 1.2rem;">${metrics.totalCalls}</div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-5" style="padding: 10px;">
                        <div class="funnel-label" style="font-size: 0.7rem;">üíº Vendas</div>
                        <div class="funnel-value" style="font-size: 1.2rem;">${metrics.totalVendas}</div>
                    </div>
                </div>
            `;
        }

        function renderMetricComparison(label, value, isCurrency, suffix = '') {
            const displayValue = isCurrency 
                ? `R$ ${value.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`
                : suffix === '%' 
                    ? `${value.toFixed(2)}%`
                    : suffix === 'x'
                        ? `${value.toFixed(2)}x`
                        : value;
            
            return `
                <div class="comparison-metric">
                    <span class="comparison-metric-label">${label}</span>
                    <span class="comparison-metric-value">${displayValue}</span>
                </div>
            `;
        }

        function generateFunilInsights(product1, product2, metrics1, metrics2) {
            const insights = [];
            
            // ROI
            const roiDiff = metrics1.roi - metrics2.roi;
            if (Math.abs(roiDiff) > 5) {
                const better = roiDiff > 0 ? product1.name : product2.name;
                const worse = roiDiff > 0 ? product2.name : product1.name;
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">${roiDiff > 0 ? 'üìà' : 'üìâ'}</span>
                        <span><strong>${better}</strong> tem ROI <strong>${Math.abs(roiDiff).toFixed(2)}%</strong> ${roiDiff > 0 ? 'maior' : 'menor'} que <strong>${worse}</strong></span>
                    </div>
                `);
            }
            
            // Faturamento
            const fatDiff = ((metrics1.totalFaturamento - metrics2.totalFaturamento) / metrics2.totalFaturamento * 100);
            if (Math.abs(fatDiff) > 10) {
                const better = fatDiff > 0 ? product1.name : product2.name;
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">üí∞</span>
                        <span><strong>${better}</strong> fatura <strong>${Math.abs(fatDiff).toFixed(0)}%</strong> a mais no per√≠odo</span>
                    </div>
                `);
            }
            
            // Taxa de Convers√£o
            const convDiff = metrics1.taxaConversao - metrics2.taxaConversao;
            if (Math.abs(convDiff) > 2) {
                const better = convDiff > 0 ? product1.name : product2.name;
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">üéØ</span>
                        <span><strong>${better}</strong> tem taxa de convers√£o <strong>${Math.abs(convDiff).toFixed(2)}%</strong> superior</span>
                    </div>
                `);
            }
            
            // Recomenda√ß√£o
            const winner = metrics1.roi > metrics2.roi ? product1.name : product2.name;
            insights.push(`
                <div class="comparison-insight-item">
                    <span class="comparison-insight-icon">üí°</span>
                    <span>Recomenda√ß√£o: Considere aumentar o investimento em <strong>${winner}</strong> que apresenta melhor performance geral</span>
                </div>
            `);
            
            return insights.join('');
        }

        // FUN√á√ïES DE COMPARA√á√ÉO DE MESES
        let monthComparisonData = {};

        function renderMonthComparison() {
            updateMonthComparison();
        }

        async function updateMonthComparison() {
            const month1Id = document.getElementById('month1Select').value;
            const month2Id = document.getElementById('month2Select').value;
            
            // Carregar dados dos dois meses
            await loadMonthData(month1Id, 1);
            await loadMonthData(month2Id, 2);
            
            const month1 = MONTHS.find(m => m.id === month1Id);
            const month2 = MONTHS.find(m => m.id === month2Id);
            
            if (!monthComparisonData.month1 || !monthComparisonData.month2) return;
            
            const metrics1 = calculateMonthMetrics(monthComparisonData.month1);
            const metrics2 = calculateMonthMetrics(monthComparisonData.month2);
            
            const container = document.getElementById('monthComparisonContent');
            
            const winner = metrics1.totalFaturamento > metrics2.totalFaturamento ? 1 : 2;
            const variation = ((metrics1.totalFaturamento - metrics2.totalFaturamento) / metrics2.totalFaturamento * 100);
            
            let html = `
                <!-- Compara√ß√£o Geral -->
                <div class="comparison-grid">
                    <div class="comparison-column ${winner === 1 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-title">üìÖ ${month1.name}</div>
                            ${winner === 1 ? '<div class="comparison-winner-badge">üèÜ MELHOR M√äS</div>' : ''}
                        </div>
                        <div class="comparison-metrics">
                            ${renderMetricComparison('üí∞ Investido', metrics1.totalInvestido, true)}
                            ${renderMetricComparison('üíµ Faturamento', metrics1.totalFaturamento, true)}
                            ${renderMetricComparison('üìä Lucro', metrics1.totalLucro, true)}
                            ${renderMetricComparison('üéØ ROI', metrics1.roi, false, '%')}
                            ${renderMetricComparison('üìà ROAS', metrics1.roas, false, 'x')}
                            ${renderMetricComparison('üë• Total Alunos', metrics1.totalAlunos, false)}
                            ${renderMetricComparison('üíº Total Vendas', metrics1.totalVendas, false)}
                            ${renderMetricComparison('üìä Taxa Convers√£o M√©dia', metrics1.taxaConversaoMedia, false, '%')}
                        </div>
                    </div>
                    
                    <div class="comparison-column ${winner === 2 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-title">üìÖ ${month2.name}</div>
                            ${winner === 2 ? '<div class="comparison-winner-badge">üèÜ MELHOR M√äS</div>' : ''}
                        </div>
                        <div class="comparison-metrics">
                            ${renderMetricComparison('üí∞ Investido', metrics2.totalInvestido, true)}
                            ${renderMetricComparison('üíµ Faturamento', metrics2.totalFaturamento, true)}
                            ${renderMetricComparison('üìä Lucro', metrics2.totalLucro, true)}
                            ${renderMetricComparison('üéØ ROI', metrics2.roi, false, '%')}
                            ${renderMetricComparison('üìà ROAS', metrics2.roas, false, 'x')}
                            ${renderMetricComparison('üë• Total Alunos', metrics2.totalAlunos, false)}
                            ${renderMetricComparison('üíº Total Vendas', metrics2.totalVendas, false)}
                            ${renderMetricComparison('üìä Taxa Convers√£o M√©dia', metrics2.taxaConversaoMedia, false, '%')}
                        </div>
                    </div>
                </div>
                
                <!-- Varia√ß√£o -->
                <div class="comparison-diff">
                    <span class="comparison-diff-arrow">${variation >= 0 ? 'üìà' : 'üìâ'}</span>
                    <div>
                        <div class="comparison-diff-value ${variation >= 0 ? 'positive' : 'negative'}">
                            ${variation >= 0 ? '+' : ''}${variation.toFixed(2)}%
                        </div>
                        <div style="color: #94a3b8; font-size: 0.9rem; text-align: center;">
                            Varia√ß√£o de Faturamento
                        </div>
                    </div>
                </div>
                
                <!-- Insights -->
                <div class="comparison-insights">
                    <div class="comparison-insights-title">
                        ü§ñ Insights da Compara√ß√£o
                    </div>
                    <div class="comparison-insights-list">
                        ${generateMonthInsights(month1, month2, metrics1, metrics2, variation)}
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }

        async function loadMonthData(monthId, monthNumber) {
            const month = MONTHS.find(m => m.id === monthId);
            if (!month) return;

            const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${month.gid}`;
            
            try {
                const response = await fetch(url);
                const csvText = await response.text();
                
                return new Promise((resolve) => {
                    Papa.parse(csvText, {
                        complete: function(results) {
                            const tempData = {};
                            const productRanges = {
                                'Geral': { start: 1, end: 4, tendencia: 5 },
                                '50 Scripts': { start: 8, end: 11, tendencia: 12 },
                                'Teste': { start: 15, end: 18, tendencia: 19 },
                                'IA Julia': { start: 22, end: 25, tendencia: 26 },
                                'MPM': { start: 29, end: 32, tendencia: 33 },
                                'Couply': { start: 36, end: 39, tendencia: 40 }
                            };

                            for (const [productName, range] of Object.entries(productRanges)) {
                                const semanas = [];
                                for (let i = range.start; i <= range.end; i++) {
                                    const row = results.data[i];
                                    if (!row) continue;
                                    semanas.push(parseRow(row));
                                }
                                const tendenciaRow = results.data[range.tendencia];
                                const tendencia = tendenciaRow ? parseRow(tendenciaRow) : null;
                                tempData[productName] = { semanas, tendencia };
                            }
                            
                            monthComparisonData[`month${monthNumber}`] = tempData;
                            resolve();
                        }
                    });
                });
            } catch (error) {
                console.error('Erro ao carregar dados do m√™s:', error);
            }
        }

        function calculateMonthMetrics(monthData) {
            const geralData = monthData['Geral'];
            if (!geralData) return {};
            
            const { semanas } = geralData;
            
            const totalInvestido = semanas.reduce((sum, s) => sum + s.investido, 0);
            const totalFaturamento = semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0);
            const totalLucro = semanas.reduce((sum, s) => sum + s.roasTrafego, 0);
            const totalAlunos = semanas.reduce((sum, s) => sum + s.alunos, 0);
            const totalVendas = semanas.reduce((sum, s) => sum + s.numeroVenda, 0);
            const taxaConversaoMedia = semanas.reduce((sum, s) => sum + s.taxaConversao, 0) / semanas.length;
            
            return {
                totalInvestido,
                totalFaturamento,
                totalLucro,
                totalAlunos,
                totalVendas,
                taxaConversaoMedia,
                roi: totalInvestido > 0 ? ((totalFaturamento - totalInvestido) / totalInvestido * 100) : 0,
                roas: totalInvestido > 0 ? (totalFaturamento / totalInvestido) : 0
            };
        }

        function generateMonthInsights(month1, month2, metrics1, metrics2, variation) {
            const insights = [];
            
            // Varia√ß√£o de faturamento
            if (Math.abs(variation) > 10) {
                const betterMonth = variation > 0 ? month1.name : month2.name;
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">${variation > 0 ? 'üöÄ' : 'üìâ'}</span>
                        <span><strong>${betterMonth}</strong> teve faturamento <strong>${Math.abs(variation).toFixed(0)}%</strong> ${variation > 0 ? 'superior' : 'inferior'}</span>
                    </div>
                `);
            }
            
            // ROI
            const roiDiff = metrics1.roi - metrics2.roi;
            if (Math.abs(roiDiff) > 10) {
                const betterMonth = roiDiff > 0 ? month1.name : month2.name;
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">üí∞</span>
                        <span><strong>${betterMonth}</strong> teve ROI <strong>${Math.abs(roiDiff).toFixed(2)}%</strong> melhor</span>
                    </div>
                `);
            }
            
            // Vendas
            const vendasDiff = metrics1.totalVendas - metrics2.totalVendas;
            if (vendasDiff !== 0) {
                const betterMonth = vendasDiff > 0 ? month1.name : month2.name;
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">üíº</span>
                        <span><strong>${betterMonth}</strong> teve <strong>${Math.abs(vendasDiff)}</strong> vendas a mais</span>
                    </div>
                `);
            }
            
            // Tend√™ncia
            if (variation > 0) {
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">üìà</span>
                        <span>Tend√™ncia positiva! O neg√≥cio est√° crescendo. Continue investindo nas estrat√©gias que est√£o funcionando.</span>
                    </div>
                `);
            } else {
                insights.push(`
                    <div class="comparison-insight-item">
                        <span class="comparison-insight-icon">‚ö†Ô∏è</span>
                        <span>Aten√ß√£o: Houve queda na performance. Analise o que mudou e ajuste a estrat√©gia.</span>
                    </div>
                `);
            }
            
            return insights.join('');
        }

        // FUN√á√ïES DE COMPARA√á√ÉO (LEGADO - REMOVIDO)
        function renderComparacao() {
            // Renderiza a compara√ß√£o entre meses ao entrar no m√≥dulo
            updateMonthComparison();
        }

        function updateComparison() {
            updateMonthComparison();
        }

        // COMPARA√á√ÉO ENTRE FUNIS
        function updateFunilComparison() {
            const funil1 = document.getElementById('funil1Select').value;
            const funil2 = document.getElementById('funil2Select').value;
            
            const data1 = allData[funil1];
            const data2 = allData[funil2];
            
            if (!data1 || !data2) return;
            
            // Calcular totais
            const totals1 = {
                alunos: data1.semanas.reduce((sum, s) => sum + s.alunos, 0),
                qualificados: data1.semanas.reduce((sum, s) => sum + s.qualificados, 0),
                agendados: data1.semanas.reduce((sum, s) => sum + s.agendados, 0),
                callRealizada: data1.semanas.reduce((sum, s) => sum + s.callRealizada, 0),
                vendas: data1.semanas.reduce((sum, s) => sum + s.numeroVenda, 0),
                investido: data1.semanas.reduce((sum, s) => sum + s.investido, 0),
                faturado: data1.semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0),
                lucro: data1.semanas.reduce((sum, s) => sum + s.roasTrafego, 0)
            };
            
            const totals2 = {
                alunos: data2.semanas.reduce((sum, s) => sum + s.alunos, 0),
                qualificados: data2.semanas.reduce((sum, s) => sum + s.qualificados, 0),
                agendados: data2.semanas.reduce((sum, s) => sum + s.agendados, 0),
                callRealizada: data2.semanas.reduce((sum, s) => sum + s.callRealizada, 0),
                vendas: data2.semanas.reduce((sum, s) => sum + s.numeroVenda, 0),
                investido: data2.semanas.reduce((sum, s) => sum + s.investido, 0),
                faturado: data2.semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0),
                lucro: data2.semanas.reduce((sum, s) => sum + s.roasTrafego, 0)
            };
            
            // Calcular taxas
            const taxas1 = {
                qualificacao: totals1.alunos > 0 ? (totals1.qualificados / totals1.alunos * 100) : 0,
                agendamento: totals1.qualificados > 0 ? (totals1.agendados / totals1.qualificados * 100) : 0,
                comparecimento: totals1.agendados > 0 ? (totals1.callRealizada / totals1.agendados * 100) : 0,
                conversao: totals1.callRealizada > 0 ? (totals1.vendas / totals1.callRealizada * 100) : 0,
                roi: totals1.investido > 0 ? ((totals1.faturado - totals1.investido) / totals1.investido * 100) : 0,
                roas: totals1.investido > 0 ? (totals1.faturado / totals1.investido) : 0
            };
            
            const taxas2 = {
                qualificacao: totals2.alunos > 0 ? (totals2.qualificados / totals2.alunos * 100) : 0,
                agendamento: totals2.qualificados > 0 ? (totals2.agendados / totals2.qualificados * 100) : 0,
                comparecimento: totals2.agendados > 0 ? (totals2.callRealizada / totals2.agendados * 100) : 0,
                conversao: totals2.callRealizada > 0 ? (totals2.vendas / totals2.callRealizada * 100) : 0,
                roi: totals2.investido > 0 ? ((totals2.faturado - totals2.investido) / totals2.investido * 100) : 0,
                roas: totals2.investido > 0 ? (totals2.faturado / totals2.investido) : 0
            };
            
            // Determinar vencedor
            const score1 = taxas1.roi + taxas1.conversao + taxas1.roas;
            const score2 = taxas2.roi + taxas2.conversao + taxas2.roas;
            const winner = score1 > score2 ? 1 : 2;
            
            const container = document.getElementById('funilComparisonContent');
            container.innerHTML = `
                <div class="comparison-container">
                    <div class="comparison-side ${winner === 1 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-header-title">${funil1}</div>
                            <div class="comparison-header-subtitle">Per√≠odo: ${MONTHS.find(m => m.id === currentMonth).name}</div>
                            ${winner === 1 ? '<div class="comparison-winner-badge">üèÜ VENCEDOR</div>' : ''}
                        </div>
                        
                        <div class="comparison-funnel-mini">
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üë• Alunos</div>
                                <div class="comparison-stage-value">${totals1.alunos}</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">‚úÖ Qualificados</div>
                                <div class="comparison-stage-value">${totals1.qualificados}</div>
                                <div class="comparison-stage-percent">${taxas1.qualificacao.toFixed(1)}% dos alunos</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üìÖ Agendados</div>
                                <div class="comparison-stage-value">${totals1.agendados}</div>
                                <div class="comparison-stage-percent">${taxas1.agendamento.toFixed(1)}% dos qualificados</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üìû Realizadas</div>
                                <div class="comparison-stage-value">${totals1.callRealizada}</div>
                                <div class="comparison-stage-percent">${taxas1.comparecimento.toFixed(1)}% dos agendados</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üíº Vendas</div>
                                <div class="comparison-stage-value">${totals1.vendas}</div>
                                <div class="comparison-stage-percent">${taxas1.conversao.toFixed(1)}% das realizadas</div>
                            </div>
                        </div>
                        
                        <div class="comparison-metrics">
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∏ Investido</span>
                                <span class="comparison-metric-value">R$ ${totals1.investido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∞ Faturado</span>
                                <span class="comparison-metric-value">R$ ${totals1.faturado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìä Lucro</span>
                                <span class="comparison-metric-value ${totals1.lucro >= 0 ? 'positive' : 'negative'}">R$ ${totals1.lucro.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìà ROI</span>
                                <span class="comparison-metric-value ${taxas1.roi >= 0 ? 'positive' : 'negative'}">${taxas1.roi >= 0 ? '+' : ''}${taxas1.roi.toFixed(2)}%</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üéØ ROAS</span>
                                <span class="comparison-metric-value">${taxas1.roas.toFixed(2)}x</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="comparison-side ${winner === 2 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-header-title">${funil2}</div>
                            <div class="comparison-header-subtitle">Per√≠odo: ${MONTHS.find(m => m.id === currentMonth).name}</div>
                            ${winner === 2 ? '<div class="comparison-winner-badge">üèÜ VENCEDOR</div>' : ''}
                        </div>
                        
                        <div class="comparison-funnel-mini">
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üë• Alunos</div>
                                <div class="comparison-stage-value">${totals2.alunos}</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">‚úÖ Qualificados</div>
                                <div class="comparison-stage-value">${totals2.qualificados}</div>
                                <div class="comparison-stage-percent">${taxas2.qualificacao.toFixed(1)}% dos alunos</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üìÖ Agendados</div>
                                <div class="comparison-stage-value">${totals2.agendados}</div>
                                <div class="comparison-stage-percent">${taxas2.agendamento.toFixed(1)}% dos qualificados</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üìû Realizadas</div>
                                <div class="comparison-stage-value">${totals2.callRealizada}</div>
                                <div class="comparison-stage-percent">${taxas2.comparecimento.toFixed(1)}% dos agendados</div>
                            </div>
                            <div class="comparison-stage">
                                <div class="comparison-stage-label">üíº Vendas</div>
                                <div class="comparison-stage-value">${totals2.vendas}</div>
                                <div class="comparison-stage-percent">${taxas2.conversao.toFixed(1)}% das realizadas</div>
                            </div>
                        </div>
                        
                        <div class="comparison-metrics">
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∏ Investido</span>
                                <span class="comparison-metric-value">R$ ${totals2.investido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∞ Faturado</span>
                                <span class="comparison-metric-value">R$ ${totals2.faturado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìä Lucro</span>
                                <span class="comparison-metric-value ${totals2.lucro >= 0 ? 'positive' : 'negative'}">R$ ${totals2.lucro.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìà ROI</span>
                                <span class="comparison-metric-value ${taxas2.roi >= 0 ? 'positive' : 'negative'}">${taxas2.roi >= 0 ? '+' : ''}${taxas2.roi.toFixed(2)}%</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üéØ ROAS</span>
                                <span class="comparison-metric-value">${taxas2.roas.toFixed(2)}x</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="comparison-analysis">
                    <div class="comparison-analysis-title">üí° An√°lise Comparativa</div>
                    <div class="comparison-analysis-content">
                        ${winner === 1 ? `
                            <strong>${funil1}</strong> est√° performando melhor que <strong>${funil2}</strong> no per√≠odo analisado.<br><br>
                            
                            <strong>Destaques de ${funil1}:</strong><br>
                            ‚Ä¢ ROI: ${taxas1.roi >= 0 ? '+' : ''}${taxas1.roi.toFixed(2)}% ${taxas1.roi > taxas2.roi ? '(melhor)' : ''}<br>
                            ‚Ä¢ Taxa de Convers√£o: ${taxas1.conversao.toFixed(1)}% ${taxas1.conversao > taxas2.conversao ? '(melhor)' : ''}<br>
                            ‚Ä¢ ROAS: ${taxas1.roas.toFixed(2)}x ${taxas1.roas > taxas2.roas ? '(melhor)' : ''}<br><br>
                            
                            <strong>Recomenda√ß√£o:</strong> Analise as estrat√©gias de ${funil1} e considere aplic√°-las em ${funil2} para melhorar os resultados.
                        ` : `
                            <strong>${funil2}</strong> est√° performando melhor que <strong>${funil1}</strong> no per√≠odo analisado.<br><br>
                            
                            <strong>Destaques de ${funil2}:</strong><br>
                            ‚Ä¢ ROI: ${taxas2.roi >= 0 ? '+' : ''}${taxas2.roi.toFixed(2)}% ${taxas2.roi > taxas1.roi ? '(melhor)' : ''}<br>
                            ‚Ä¢ Taxa de Convers√£o: ${taxas2.conversao.toFixed(1)}% ${taxas2.conversao > taxas1.conversao ? '(melhor)' : ''}<br>
                            ‚Ä¢ ROAS: ${taxas2.roas.toFixed(2)}x ${taxas2.roas > taxas1.roas ? '(melhor)' : ''}<br><br>
                            
                            <strong>Recomenda√ß√£o:</strong> Analise as estrat√©gias de ${funil2} e considere aplic√°-las em ${funil1} para melhorar os resultados.
                        `}
                    </div>
                </div>
            `;
        }

        // COMPARA√á√ÉO ENTRE MESES
        async function updateMonthComparison() {
            const month1Id = document.getElementById('month1Select').value;
            const month2Id = document.getElementById('month2Select').value;
            
            const month1 = MONTHS.find(m => m.id === month1Id);
            const month2 = MONTHS.find(m => m.id === month2Id);
            
            if (!month1 || !month2) return;
            
            const container = document.getElementById('monthComparisonContent');
            container.innerHTML = '<div style="text-align: center; padding: 50px; color: #94a3b8;">Carregando dados...</div>';
            
            try {
                // Carregar dados do m√™s 1
                const url1 = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${month1.gid}`;
                const response1 = await fetch(url1);
                const csvText1 = await response1.text();
                
                // Carregar dados do m√™s 2
                const url2 = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${month2.gid}`;
                const response2 = await fetch(url2);
                const csvText2 = await response2.text();
                
                // Parse dos dados
                let data1, data2;
                
                Papa.parse(csvText1, {
                    complete: function(results) {
                        data1 = parseMonthData(results.data);
                    }
                });
                
                Papa.parse(csvText2, {
                    complete: function(results) {
                        data2 = parseMonthData(results.data);
                        renderMonthComparisonContent(month1, month2, data1, data2);
                    }
                });
                
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                container.innerHTML = '<div style="text-align: center; padding: 50px; color: #ef4444;">Erro ao carregar dados. Tente novamente.</div>';
            }
        }

        function parseMonthData(data) {
            // Parse simplificado para o Geral
            const geralData = {
                investido: 0,
                faturado: 0,
                lucro: 0,
                alunos: 0,
                qualificados: 0,
                agendados: 0,
                callRealizada: 0,
                vendas: 0
            };
            
            for (let i = 1; i <= 4; i++) {
                const row = data[i];
                if (!row) continue;
                
                geralData.investido += parseFloat(row[1]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.faturado += parseFloat(row[2]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.lucro += parseFloat(row[3]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.alunos += parseFloat(row[4]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.qualificados += parseFloat(row[5]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.agendados += parseFloat(row[6]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.callRealizada += parseFloat(row[9]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                geralData.vendas += parseFloat(row[11]?.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
            }
            
            return geralData;
        }

        function renderMonthComparisonContent(month1, month2, data1, data2) {
            const taxas1 = {
                roi: data1.investido > 0 ? ((data1.faturado - data1.investido) / data1.investido * 100) : 0,
                roas: data1.investido > 0 ? (data1.faturado / data1.investido) : 0,
                conversao: data1.callRealizada > 0 ? (data1.vendas / data1.callRealizada * 100) : 0
            };
            
            const taxas2 = {
                roi: data2.investido > 0 ? ((data2.faturado - data2.investido) / data2.investido * 100) : 0,
                roas: data2.investido > 0 ? (data2.faturado / data2.investido) : 0,
                conversao: data2.callRealizada > 0 ? (data2.vendas / data2.callRealizada * 100) : 0
            };
            
            const winner = (taxas1.roi + taxas1.roas + taxas1.conversao) > (taxas2.roi + taxas2.roas + taxas2.conversao) ? 1 : 2;
            
            const container = document.getElementById('monthComparisonContent');
            container.innerHTML = `
                <div class="comparison-container">
                    <div class="comparison-side ${winner === 1 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-header-title">${month1.name}</div>
                            ${winner === 1 ? '<div class="comparison-winner-badge">üèÜ MELHOR M√äS</div>' : ''}
                        </div>
                        
                        <div class="comparison-metrics">
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üë• Alunos</span>
                                <span class="comparison-metric-value">${data1.alunos}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üíº Vendas</span>
                                <span class="comparison-metric-value">${data1.vendas}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∏ Investido</span>
                                <span class="comparison-metric-value">R$ ${data1.investido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∞ Faturado</span>
                                <span class="comparison-metric-value">R$ ${data1.faturado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìä Lucro</span>
                                <span class="comparison-metric-value ${data1.lucro >= 0 ? 'positive' : 'negative'}">R$ ${data1.lucro.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìà ROI</span>
                                <span class="comparison-metric-value ${taxas1.roi >= 0 ? 'positive' : 'negative'}">${taxas1.roi >= 0 ? '+' : ''}${taxas1.roi.toFixed(2)}%</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üéØ ROAS</span>
                                <span class="comparison-metric-value">${taxas1.roas.toFixed(2)}x</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üíº Taxa Convers√£o</span>
                                <span class="comparison-metric-value">${taxas1.conversao.toFixed(1)}%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="comparison-side ${winner === 2 ? 'winner' : ''}">
                        <div class="comparison-header">
                            <div class="comparison-header-title">${month2.name}</div>
                            ${winner === 2 ? '<div class="comparison-winner-badge">üèÜ MELHOR M√äS</div>' : ''}
                        </div>
                        
                        <div class="comparison-metrics">
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üë• Alunos</span>
                                <span class="comparison-metric-value">${data2.alunos}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üíº Vendas</span>
                                <span class="comparison-metric-value">${data2.vendas}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∏ Investido</span>
                                <span class="comparison-metric-value">R$ ${data2.investido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üí∞ Faturado</span>
                                <span class="comparison-metric-value">R$ ${data2.faturado.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìä Lucro</span>
                                <span class="comparison-metric-value ${data2.lucro >= 0 ? 'positive' : 'negative'}">R$ ${data2.lucro.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üìà ROI</span>
                                <span class="comparison-metric-value ${taxas2.roi >= 0 ? 'positive' : 'negative'}">${taxas2.roi >= 0 ? '+' : ''}${taxas2.roi.toFixed(2)}%</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üéØ ROAS</span>
                                <span class="comparison-metric-value">${taxas2.roas.toFixed(2)}x</span>
                            </div>
                            <div class="comparison-metric">
                                <span class="comparison-metric-label">üíº Taxa Convers√£o</span>
                                <span class="comparison-metric-value">${taxas2.conversao.toFixed(1)}%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="comparison-analysis">
                    <div class="comparison-analysis-title">üìä Compara√ß√£o de Varia√ß√£o</div>
                    <div class="comparison-analysis-content">
                        <strong>Varia√ß√µes de ${month1.name} para ${month2.name}:</strong><br><br>
                        
                        ‚Ä¢ Alunos: ${((data2.alunos - data1.alunos) / data1.alunos * 100).toFixed(1)}% ${data2.alunos > data1.alunos ? 'üìà' : 'üìâ'}<br>
                        ‚Ä¢ Vendas: ${((data2.vendas - data1.vendas) / data1.vendas * 100).toFixed(1)}% ${data2.vendas > data1.vendas ? 'üìà' : 'üìâ'}<br>
                        ‚Ä¢ Faturado: ${((data2.faturado - data1.faturado) / data1.faturado * 100).toFixed(1)}% ${data2.faturado > data1.faturado ? 'üìà' : 'üìâ'}<br>
                        ‚Ä¢ ROI: ${(taxas2.roi - taxas1.roi).toFixed(2)}% ${taxas2.roi > taxas1.roi ? 'üìà' : 'üìâ'}<br>
                        ‚Ä¢ ROAS: ${(taxas2.roas - taxas1.roas).toFixed(2)}x ${taxas2.roas > taxas1.roas ? 'üìà' : 'üìâ'}<br><br>
                        
                        <strong>${winner === 1 ? month1.name : month2.name}</strong> teve melhor performance geral, com ${winner === 1 ? 'ROI de ' + taxas1.roi.toFixed(2) : 'ROI de ' + taxas2.roi.toFixed(2)}%.
                    </div>
                </div>
            `;
        }

        // FUN√á√ïES DE EXPORTA√á√ÉO
        function exportPDF() {
            alert('üìÑ Exporta√ß√£o para PDF em desenvolvimento!\n\nEm breve voc√™ poder√° baixar um relat√≥rio completo em PDF com todos os gr√°ficos e dados.');
        }

        function exportExcel() {
            alert('üìä Exporta√ß√£o para Excel em desenvolvimento!\n\nEm breve voc√™ poder√° baixar uma planilha Excel com todos os dados detalhados.');
        }

        function exportCSV() {
            alert('üìã Exporta√ß√£o para CSV em desenvolvimento!\n\nEm breve voc√™ poder√° baixar os dados em formato CSV para importar em outras ferramentas.');
        }

        function shareLink() {
            alert('üîó Compartilhamento em desenvolvimento!\n\nEm breve voc√™ poder√° gerar um link compartilh√°vel do dashboard.');
        }

        // MODO APRESENTA√á√ÉO
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    document.querySelector('.left-sidebar').style.display = 'none';
                    document.querySelector('.fullscreen-btn').innerHTML = 'üîô';
                });
            } else {
                document.exitFullscreen().then(() => {
                    document.querySelector('.left-sidebar').style.display = 'flex';
                    document.querySelector('.fullscreen-btn').innerHTML = 'üñ•Ô∏è';
                });
            }
        }

        // HELPER: Renderizar seletor de m√™s para m√≥dulos
        function renderMonthSelectorForModule(containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = MONTHS.map(month => `
                <button class="month-btn ${month.id === currentMonth ? 'active' : ''}" 
                        onclick="selectMonth('${month.id}')">
                    ${month.name}
                </button>
            `).join('');
        }

        const SHEET_ID = '1V0-yWzGbDWUEQ21CPtNcHrzPQfLTXKHNBYUlSfzO2Pc';
        
        const MONTHS = [
            { id: 'out', name: 'Outubro', gid: '0' },
            { id: 'nov', name: 'Novembro', gid: '799831430' },
            { id: 'dez', name: 'Dezembro', gid: '1796217875' },
            { id: 'jan', name: 'Janeiro', gid: '1107738440' },
            { id: 'fev', name: 'Fevereiro', gid: '668056747' }
        ];

        const allProducts = [
            { id: 'Geral', name: 'Geral', icon: 'üìä', team: 'geral' },
            { id: '50 Scripts', name: '50 Scripts', icon: 'üìù', team: 'cleiton' },
            { id: 'Couply', name: 'Couply', icon: 'üíë', team: 'cleiton' },
            { id: 'Teste', name: 'Teste', icon: 'üß™', team: 'julia' },
            { id: 'IA Julia', name: 'IA Julia', icon: 'ü§ñ', team: 'julia' },
            { id: 'MPM', name: 'MPM', icon: 'üìä', team: 'julia' }
        ];

        let currentMonth = 'nov';
        let currentTeam = 'geral';
        let currentProduct = 'Geral';
        let currentWeek = 'total';
        let allData = {};

        async function loadData() {
            const month = MONTHS.find(m => m.id === currentMonth);
            if (!month) return;

            const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${month.gid}`;
            
            try {
                const response = await fetch(url);
                const csvText = await response.text();
                
                Papa.parse(csvText, {
                    complete: function(results) {
                        parseSheetData(results.data);
                        renderUI();
                    }
                });
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
            }
        }

        function parseSheetData(data) {
            const productRanges = {
                'Geral': { start: 1, end: 4, tendencia: 5 },
                '50 Scripts': { start: 8, end: 11, tendencia: 12 },
                'Teste': { start: 15, end: 18, tendencia: 19 },
                'IA Julia': { start: 22, end: 25, tendencia: 26 },
                'MPM': { start: 29, end: 32, tendencia: 33 },
                'Couply': { start: 36, end: 39, tendencia: 40 }
            };

            allData = {};

            for (const [productName, range] of Object.entries(productRanges)) {
                const semanas = [];
                
                for (let i = range.start; i <= range.end; i++) {
                    const row = data[i];
                    if (!row) continue;
                    semanas.push(parseRow(row));
                }

                const tendenciaRow = data[range.tendencia];
                const tendencia = tendenciaRow ? parseRow(tendenciaRow) : null;

                allData[productName] = { semanas, tendencia };
            }
        }

        function parseRow(row) {
            const parseValue = (val) => {
                if (!val || val === '#N/A' || val === '#DIV/0!') return 0;
                let cleanVal = val.toString().replace(/[^\d,.-]/g, '');
                cleanVal = cleanVal.replace(/\./g, '');
                cleanVal = cleanVal.replace(',', '.');
                return parseFloat(cleanVal) || 0;
            };

            return {
                investido: parseValue(row[1]),           // Coluna B
                faturamentoTrafego: parseValue(row[2]),  // Coluna C
                roasTrafego: parseValue(row[3]),         // Coluna D (Lucro Tr√°fego)
                alunos: parseValue(row[4]),              // Coluna E
                qualificados: parseValue(row[5]),        // Coluna F
                agendados: parseValue(row[6]),           // Coluna G
                taxaAgendamento: parseValue(row[7]),     // Coluna H
                callRealizada: parseValue(row[8]),       // Coluna I
                taxaComparecimento: parseValue(row[9]),  // Coluna J
                numeroVenda: parseValue(row[10]),        // Coluna K
                taxaConversao: parseValue(row[11]),      // Coluna L
                taxaAscensao: parseValue(row[12]),       // Coluna M
                vendaMonetizacao: parseValue(row[13]),   // Coluna N
                entradas: parseValue(row[14]),           // Coluna O
                faturamentoFunil: parseValue(row[15]),   // Coluna P
                lucroFunil: parseValue(row[16])          // Coluna Q (Roas do funil)
            };
        }

        function renderUI() {
            renderMonthButtons();
            renderProductButtons();
            renderStatsPanel();
            updateFunnel();
            renderBottomCards();
            renderRanking();
            
            // Atualiza m√≥dulo ativo se n√£o for o dashboard
            const activeModule = document.querySelector('.sidebar-btn.active')?.dataset?.module;
            if (activeModule && activeModule !== 'dashboard') {
                showModule(activeModule);
            }
        }

        function renderMonthButtons() {
            const container = document.getElementById('monthSelector');
            container.innerHTML = MONTHS.map(month => `
                <button class="month-btn ${month.id === currentMonth ? 'active' : ''}" 
                        onclick="selectMonth('${month.id}')">
                    ${month.name}
                </button>
            `).join('');
        }

        function renderProductButtons() {
            const container = document.getElementById('productSelector');
            
            // Se o time for geral, n√£o mostra bot√µes de produtos
            if (currentTeam === 'geral') {
                container.innerHTML = '';
                return;
            }
            
            const teamProducts = allProducts.filter(p => p.team === currentTeam);
            
            container.innerHTML = teamProducts.map(product => `
                <button class="product-btn ${product.id === currentProduct ? 'active' : ''}" 
                        onclick="selectProduct('${product.id}')">
                    ${product.icon} ${product.name}
                </button>
            `).join('');
        }

        function renderStatsPanel() {
            const data = allData[currentProduct];
            if (!data) return;

            const { semanas, tendencia } = data;
            
            // TOTAIS REAIS (soma das semanas)
            const totalFaturamentoTrafego = semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0);
            const totalInvestido = semanas.reduce((sum, s) => sum + s.investido, 0);
            const totalRoasTrafego = semanas.reduce((sum, s) => sum + s.roasTrafego, 0);
            const totalVendaMonetizacao = semanas.reduce((sum, s) => sum + s.vendaMonetizacao, 0);
            const totalEntradas = semanas.reduce((sum, s) => sum + s.entradas, 0);

            const container = document.getElementById('statsPanel');
            
            let html = `
                <div class="stats-block aquisicao">
                    <div class="stats-block-title">üéØ AQUISI√á√ÉO</div>
                    <div class="stat-item">
                        <span class="stat-item-label">üí∞ Faturamento Tr√°fego</span>
                        <span class="stat-item-value">R$ ${totalFaturamentoTrafego.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-item-label">üí∏ Investimento</span>
                        <span class="stat-item-value">R$ ${totalInvestido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-item-label">üìä Lucro Tr√°fego</span>
                        <span class="stat-item-value ${totalRoasTrafego >= 0 ? 'positive' : 'negative'}">R$ ${totalRoasTrafego.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                </div>
            `;

            // Adiciona tend√™ncia de aquisi√ß√£o se existir
            if (tendencia) {
                html += `
                    <div class="stats-block tendencia aquisicao">
                        <div class="stats-block-title">üìà TEND√äNCIA AQUISI√á√ÉO</div>
                        <div class="stat-item">
                            <span class="stat-item-label">üí∞ Faturamento Tr√°fego</span>
                            <span class="stat-item-value">R$ ${tendencia.faturamentoTrafego.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-item-label">üí∏ Investimento</span>
                            <span class="stat-item-value">R$ ${tendencia.investido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-item-label">üìä Lucro Tr√°fego</span>
                            <span class="stat-item-value ${tendencia.roasTrafego >= 0 ? 'positive' : 'negative'}">R$ ${tendencia.roasTrafego.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                        </div>
                    </div>
                `;
            }

            html += `
                <div class="stats-block monetizacao">
                    <div class="stats-block-title">üíµ MONETIZA√á√ÉO</div>
                    <div class="stat-item">
                        <span class="stat-item-label">üí≥ Faturamento Monetiza√ß√£o</span>
                        <span class="stat-item-value">R$ ${totalVendaMonetizacao.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-item-label">üì• Entradas</span>
                        <span class="stat-item-value">R$ ${totalEntradas.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                </div>
            `;

            // Adiciona tend√™ncia de monetiza√ß√£o se existir
            if (tendencia) {
                html += `
                    <div class="stats-block tendencia monetizacao">
                        <div class="stats-block-title">üìà TEND√äNCIA MONETIZA√á√ÉO</div>
                        <div class="stat-item">
                            <span class="stat-item-label">üí≥ Faturamento Monetiza√ß√£o</span>
                            <span class="stat-item-value">R$ ${tendencia.vendaMonetizacao.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-item-label">üì• Entradas</span>
                            <span class="stat-item-value">R$ ${tendencia.entradas.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function updateFunnel() {
            const data = allData[currentProduct];
            if (!data) return;

            const { semanas } = data;
            currentWeek = document.getElementById('weekSelect').value;

            let dataToShow;
            if (currentWeek === 'total') {
                dataToShow = {
                    alunos: semanas.reduce((sum, s) => sum + s.alunos, 0),
                    qualificados: semanas.reduce((sum, s) => sum + s.qualificados, 0),
                    agendados: semanas.reduce((sum, s) => sum + s.agendados, 0),
                    callRealizada: semanas.reduce((sum, s) => sum + s.callRealizada, 0),
                    vendas: semanas.reduce((sum, s) => sum + s.numeroVenda, 0)
                };
            } else {
                const weekIndex = parseInt(currentWeek) - 1;
                if (semanas[weekIndex]) {
                    const semana = semanas[weekIndex];
                    dataToShow = {
                        alunos: semana.alunos,
                        qualificados: semana.qualificados,
                        agendados: semana.agendados,
                        callRealizada: semana.callRealizada,
                        vendas: semana.numeroVenda
                    };
                } else {
                    dataToShow = { alunos: 0, qualificados: 0, agendados: 0, callRealizada: 0, vendas: 0 };
                }
            }

            renderFunnel(dataToShow);
        }

        function renderFunnel(data) {
            const funnelArea = document.getElementById('funnelArea');
            const chartTitle = document.getElementById('chartTitle');
            
            const periodText = currentWeek === 'total' ? 'Total do M√™s' : `Semana ${currentWeek}`;
            chartTitle.textContent = `Funil de Convers√£o - ${currentProduct} (${periodText})`;

            const { alunos, qualificados, agendados, callRealizada, vendas } = data;

            // Verificar se n√£o h√° dados
            if (alunos === 0 && qualificados === 0 && agendados === 0) {
                funnelArea.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìä</div>
                        <div class="empty-state-title">Sem dados para este per√≠odo</div>
                        <div class="empty-state-description">
                            N√£o h√° informa√ß√µes de funil para o per√≠odo selecionado. 
                            ${currentWeek !== 'total' ? 'Tente selecionar "Total do M√™s" ou outra semana.' : 'Selecione outro produto ou m√™s.'}
                        </div>
                        ${currentWeek !== 'total' ? `
                        <div class="empty-state-actions">
                            <button class="empty-state-btn" onclick="document.getElementById('weekSelect').value='total'; updateFunnel();">
                                Ver Total do M√™s
                            </button>
                        </div>
                        ` : ''}
                    </div>
                `;
                return;
            }

            funnelArea.innerHTML = `
                <div class="funnel-container">
                    <div class="funnel-stage funnel-stage-1">
                        <div class="funnel-label">üë• Alunos</div>
                        <div class="funnel-value">${alunos}</div>
                        <div class="funnel-percent">
                            <span>100%</span>
                            <span class="funnel-percent-label">(base)</span>
                        </div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-2">
                        <div class="funnel-label">‚úÖ Qualificados</div>
                        <div class="funnel-value">${qualificados}</div>
                        <div class="funnel-percent">
                            <span>${alunos > 0 ? ((qualificados / alunos) * 100).toFixed(1) : 0}%</span>
                            <span class="funnel-percent-label">(do total de alunos)</span>
                        </div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-3">
                        <div class="funnel-label">üìÖ Call Agendadas</div>
                        <div class="funnel-value">${agendados}</div>
                        <div class="funnel-percent">
                            <span>${qualificados > 0 ? ((agendados / qualificados) * 100).toFixed(1) : 0}%</span>
                            <span class="funnel-percent-label">(dos qualificados)</span>
                        </div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-4">
                        <div class="funnel-label">üìû Call Realizadas</div>
                        <div class="funnel-value">${callRealizada}</div>
                        <div class="funnel-percent">
                            <span>${agendados > 0 ? ((callRealizada / agendados) * 100).toFixed(1) : 0}%</span>
                            <span class="funnel-percent-label">(das agendadas)</span>
                        </div>
                    </div>
                    <div class="funnel-arrow">‚ñº</div>
                    <div class="funnel-stage funnel-stage-5">
                        <div class="funnel-label">üíº Vendas</div>
                        <div class="funnel-value">${vendas}</div>
                        <div class="funnel-percent">
                            <span>${callRealizada > 0 ? ((vendas / callRealizada) * 100).toFixed(1) : 0}%</span>
                            <span class="funnel-percent-label">(das realizadas)</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderBottomCards() {
            const data = allData[currentProduct];
            if (!data) return;

            const { semanas, tendencia } = data;
            
            const totalFaturamentoFunil = semanas.reduce((sum, s) => sum + s.faturamentoFunil, 0);
            const totalLucroFunil = semanas.reduce((sum, s) => sum + s.lucroFunil, 0);

            const tendenciaFaturamento = tendencia ? tendencia.faturamentoFunil : 0;
            const tendenciaLucro = tendencia ? tendencia.lucroFunil : 0;

            const container = document.getElementById('bottomCards');
            container.innerHTML = `
                <div class="bottom-card">
                    <div class="bottom-card-icon">üíµ</div>
                    <div class="bottom-card-label">Faturamento do Funil</div>
                    <div class="bottom-card-value">R$ ${totalFaturamentoFunil.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</div>
                </div>
                <div class="bottom-card tendencia">
                    <div class="bottom-card-icon">üìà</div>
                    <div class="bottom-card-label">Tend√™ncia Faturamento</div>
                    <div class="bottom-card-value" style="color: #60a5fa;">R$ ${tendenciaFaturamento.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</div>
                </div>
                <div class="bottom-card">
                    <div class="bottom-card-icon">üìä</div>
                    <div class="bottom-card-label">Lucro do Funil</div>
                    <div class="bottom-card-value" style="color: ${totalLucroFunil >= 0 ? '#10b981' : '#ef4444'}">
                        R$ ${totalLucroFunil.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                    </div>
                </div>
                <div class="bottom-card tendencia">
                    <div class="bottom-card-icon">üìà</div>
                    <div class="bottom-card-label">Tend√™ncia Lucro</div>
                    <div class="bottom-card-value" style="color: ${tendenciaLucro >= 0 ? '#34d399' : '#f87171'};">
                        R$ ${tendenciaLucro.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                    </div>
                </div>
            `;
        }

        function renderRanking() {
            const container = document.getElementById('rankingGrid');
            
            // Filtra produtos excluindo o Geral
            const produtosRanking = allProducts
                .filter(product => product.id !== 'Geral')
                .map(product => {
                    const data = allData[product.id];
                    if (!data) return null;

                    const { semanas } = data;
                    const totalInvestido = semanas.reduce((sum, s) => sum + s.investido, 0);
                    const totalFaturamentoTrafego = semanas.reduce((sum, s) => sum + s.faturamentoTrafego, 0);
                    const totalFaturamentoFunil = semanas.reduce((sum, s) => sum + s.faturamentoFunil, 0);
                    const totalLucroFunil = semanas.reduce((sum, s) => sum + s.lucroFunil, 0);
                    const totalLucroTrafego = semanas.reduce((sum, s) => sum + s.roasTrafego, 0);
                    const totalVendas = semanas.reduce((sum, s) => sum + s.numeroVenda, 0);
                    const totalVendaMonetizacao = semanas.reduce((sum, s) => sum + s.vendaMonetizacao, 0);
                    
                    // Calcula m√©dias das taxas
                    const taxaAgendamentoMedia = semanas.reduce((sum, s) => sum + s.taxaAgendamento, 0) / semanas.length;
                    const taxaConversaoMedia = semanas.reduce((sum, s) => sum + s.taxaConversao, 0) / semanas.length;
                    const taxaAscensaoMedia = semanas.reduce((sum, s) => sum + s.taxaAscensao, 0) / semanas.length;

                    return {
                        ...product,
                        totalInvestido,
                        totalFaturamentoTrafego,
                        totalFaturamentoFunil,
                        totalLucroFunil,
                        totalLucroTrafego,
                        totalVendas,
                        totalVendaMonetizacao,
                        taxaAgendamentoMedia,
                        taxaConversaoMedia,
                        taxaAscensaoMedia
                    };
                }).filter(p => p !== null);

            const rankings = [
                { 
                    title: 'üìÖ Melhor Taxa de Agendamento', 
                    icon: 'üéØ', 
                    key: 'taxaAgendamentoMedia',
                    format: (val) => `${val.toFixed(2)}%`
                },
                { 
                    title: 'üíº Melhor Taxa de Convers√£o', 
                    icon: '‚ú®', 
                    key: 'taxaConversaoMedia',
                    format: (val) => `${val.toFixed(2)}%`
                },
                { 
                    title: 'üìà Melhor Taxa de Ascens√£o', 
                    icon: 'üöÄ', 
                    key: 'taxaAscensaoMedia',
                    format: (val) => `${val >= 0 ? '+' : ''}${val.toFixed(2)}%`
                },
                { 
                    title: 'üí∞ Maior Faturamento no Tr√°fego', 
                    icon: 'üëë', 
                    key: 'totalFaturamentoTrafego',
                    format: (val) => `R$ ${val.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`
                },
                { 
                    title: 'üíµ Maior Faturamento no Funil', 
                    icon: 'üèÜ', 
                    key: 'totalFaturamentoFunil',
                    format: (val) => `R$ ${val.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`
                },
                { 
                    title: 'üìä Maior Lucro no Tr√°fego', 
                    icon: 'üíé', 
                    key: 'totalLucroTrafego',
                    format: (val) => `R$ ${val.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`
                },
                { 
                    title: 'üíé Maior Lucro no Funil', 
                    icon: 'üåü', 
                    key: 'totalLucroFunil',
                    format: (val) => `R$ ${val.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`
                },
                { 
                    title: 'üéÅ Mais Vendas', 
                    icon: 'üî•', 
                    key: 'totalVendas',
                    format: (val) => `${val} vendas`
                }
            ];

            container.innerHTML = rankings.map(ranking => {
                const sorted = [...produtosRanking].sort((a, b) => b[ranking.key] - a[ranking.key]);
                const winner = sorted[0];

                return `
                    <div class="ranking-card">
                        <div class="ranking-icon">${ranking.icon}</div>
                        <div class="ranking-label">${ranking.title}</div>
                        <div class="ranking-product">${winner.icon} ${winner.name}</div>
                        <div class="ranking-value">${ranking.format(winner[ranking.key])}</div>
                    </div>
                `;
            }).join('');
        }

        function selectMonth(monthId) {
            currentMonth = monthId;
            loadData();
        }

        function selectTeam(team) {
            currentTeam = team;
            
            // Atualiza os bot√µes de time
            document.querySelectorAll('.team-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Seleciona o produto adequado para cada time
            if (team === 'geral') {
                currentProduct = 'Geral';
            } else {
                const teamProducts = allProducts.filter(p => p.team === team);
                if (teamProducts.length > 0) {
                    currentProduct = teamProducts[0].id;
                }
            }
            
            renderUI();
        }

        function selectMonth(monthId) {
            currentMonth = monthId;
            const monthName = MONTHS.find(m => m.id === monthId)?.name || monthId;
            showToast(`Carregando dados de ${monthName}...`, 'info', 2000);
            loadData();
        }

        function selectTeam(team) {
            currentTeam = team;
            
            // Atualiza os bot√µes de time
            document.querySelectorAll('.team-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Seleciona o produto adequado para cada time
            if (team === 'geral') {
                currentProduct = 'Geral';
            } else if (team === 'cleiton') {
                currentProduct = '50 Scripts';
            } else if (team === 'julia') {
                currentProduct = 'IA Julia';
            }
            
            const teamNames = {
                'geral': 'Geral',
                'cleiton': 'Time Cleiton',
                'julia': 'Time Julia'
            };
            
            showToast(`Visualizando ${teamNames[team]} ‚ú®`, 'success', 2000);
            renderUI();
        }

        function selectProduct(productId) {
            currentProduct = productId;
            const product = allProducts.find(p => p.id === productId);
            if (product) {
                showToast(`${product.icon} ${product.name} selecionado`, 'success', 2000);
            }
            renderUI();
        }

        // Inicializar melhorias de UX/UI
        function initializeUX() {
            // Adicionar micro-intera√ß√µes
            addMicroInteractions();
            
            // Mostrar toast de boas-vindas (apenas uma vez)
            if (!sessionStorage.getItem('welcomeShown')) {
                setTimeout(() => {
                    showToast('Dashboard carregado com sucesso! üéâ', 'success', 4000);
                    sessionStorage.setItem('welcomeShown', 'true');
                }, 500);
            }
        }

        // Carregar dados e inicializar
        loadData().then(() => {
            initializeUX();
        });
    </script>
    
    <!-- Container para Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>
</body>
</html>
